<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data Import Example – Clojure Data Cookbook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./book.part_0_end_to_end.2_data_preparation_example.html" rel="next">
<link href="./src/book/part_0_end_to_end/0_intro.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link rel="icon" href="data:,">
<script defer="" src="https://cloud.umami.is/script.js" data-website-id="7612edfb-6430-4b4e-8cec-e648f6cb41cc"></script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./src/book/part_0_end_to_end/0_intro.html">End to End</a></li><li class="breadcrumb-item"><a href="./book.part_0_end_to_end.1_data_import_and_cleanup_example.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Data Import Example</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Clojure Data Cookbook</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./src/book/why-clojure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Why Clojure?</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./src/book/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./src/book/part_0_end_to_end/0_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">End to End</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book.part_0_end_to_end.1_data_import_and_cleanup_example.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Data Import Example</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book.part_0_end_to_end.2_data_preparation_example.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Transformation Example</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./src/book/part_1_data_import/0_data_import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Import</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book.part_1_data_import.1_tabular_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tabular Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book.part_1_data_import.2_columnar_compressed_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Columnar and Compressed Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book.part_1_data_import.3_databases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Databases</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book.part_1_data_import.4_the_internet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The Internet</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link active" data-scroll-target="#data-cleaning">Data cleaning</a>
  <ul>
  <li><a href="#correcting-datatypes" id="toc-correcting-datatypes" class="nav-link" data-scroll-target="#correcting-datatypes">Correcting datatypes</a></li>
  <li><a href="#reshaping-data" id="toc-reshaping-data" class="nav-link" data-scroll-target="#reshaping-data">Reshaping data</a></li>
  </ul></li>
  <li><a href="#data-integrity" id="toc-data-integrity" class="nav-link" data-scroll-target="#data-integrity">Data Integrity</a>
  <ul>
  <li><a href="#handling-missing-values" id="toc-handling-missing-values" class="nav-link" data-scroll-target="#handling-missing-values">Handling missing values</a></li>
  </ul></li>
  <li><a href="#check-for-duplicate-values" id="toc-check-for-duplicate-values" class="nav-link" data-scroll-target="#check-for-duplicate-values">Check for duplicate values</a>
  <ul>
  <li><a href="#removing-fully-duplicate-rows" id="toc-removing-fully-duplicate-rows" class="nav-link" data-scroll-target="#removing-fully-duplicate-rows">Removing fully duplicate rows</a></li>
  <li><a href="#selecting-relevant-rows" id="toc-selecting-relevant-rows" class="nav-link" data-scroll-target="#selecting-relevant-rows">Selecting relevant rows</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./src/book/part_0_end_to_end/0_intro.html">End to End</a></li><li class="breadcrumb-item"><a href="./book.part_0_end_to_end.1_data_import_and_cleanup_example.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Data Import Example</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-data-import-example" class="quarto-section-identifier"><span class="chapter-title">Data Import Example</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<style></style>
<style>.printedClojure .sourceCode {
  background-color: transparent;
  border-style: none;
}
</style>
<style>.clay-limit-image-width .clay-image {max-width: 100%}
.clay-side-by-side .sourceCode {margin: 0}
.clay-side-by-side {margin: 1em 0}
</style>
<script src="book.part_0_end_to_end.1_data_import_and_cleanup_example_files/md-default0.js" type="text/javascript"></script>
<script src="book.part_0_end_to_end.1_data_import_and_cleanup_example_files/md-default1.js" type="text/javascript"></script>
<p>TODO: Summary</p>
<p>To build a model that predicts house prices, we need data about recent sales of similar houses. Luckily the organization that tracks all of this data in my province has released it for public use under a <a href="https://www.pvsc.ca/sites/default/files/shared/Open%20Data%20and%20Information%20Government%20Licence%20-%20PVSC%20and%20Participating%20Municipalities.pdf">very permissive open data license</a>, so we’ll use that data to find what we’re looking for.</p>
<p>First we need the data about actual house sales. That’s available in this <a href="https://www.thedatazone.ca/Assessment/Parcel-Sales-History/6a95-ppg4/about_data">Parcel Sales History</a> dataset. Standard tabular file formats like <code>.csv</code> just work in tablecloth, so there’s not much to worry about here with importing the data:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb1"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> sales-history</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  (tc/dataset <span class="st">"data/end_to_end/parcel_sales_history.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can get a quick summary of the dataset with <code>tc/info</code>:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb2"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>(tc/info sales-history)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/end_to_end/parcel_sales_history.csv: descriptive-stats [14 12]:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 14%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>:col-name</th>
<th>:datatype</th>
<th style="text-align: right;">:n-valid</th>
<th style="text-align: right;">:n-missing</th>
<th style="text-align: right;">:min</th>
<th style="text-align: right;">:mean</th>
<th>:mode</th>
<th style="text-align: right;">:max</th>
<th style="text-align: right;">:standard-deviation</th>
<th style="text-align: right;">:skew</th>
<th>:first</th>
<th>:last</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Municipal Unit</td>
<td>:string</td>
<td style="text-align: right;">553234</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
</tr>
<tr class="even">
<td>Assessment Account Number</td>
<td>:int32</td>
<td style="text-align: right;">553234</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">396.000000</td>
<td style="text-align: right;">5464364.27661351</td>
<td></td>
<td style="text-align: right;">1.10765560E+07</td>
<td style="text-align: right;">3559869.76102067</td>
<td style="text-align: right;">0.18744869</td>
<td>10587948</td>
<td>3933504</td>
</tr>
<tr class="odd">
<td>Civic Number</td>
<td>:int32</td>
<td style="text-align: right;">407909</td>
<td style="text-align: right;">145325</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">1249.59833198</td>
<td></td>
<td style="text-align: right;">5.19470000E+04</td>
<td style="text-align: right;">2989.77914396</td>
<td style="text-align: right;">6.12767133</td>
<td>75</td>
<td>918</td>
</tr>
<tr class="even">
<td>Civic Additional</td>
<td>:string</td>
<td style="text-align: right;">1365</td>
<td style="text-align: right;">551869</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>A</td>
<td></td>
</tr>
<tr class="odd">
<td>Civic Direction</td>
<td>:string</td>
<td style="text-align: right;">2224</td>
<td style="text-align: right;">551010</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Civic Street Name</td>
<td>:string</td>
<td style="text-align: right;">550304</td>
<td style="text-align: right;">2930</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>HIGHWAY 1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>CENTRAL</td>
<td>NO 10</td>
</tr>
<tr class="odd">
<td>Civic Suffix</td>
<td>:string</td>
<td style="text-align: right;">497196</td>
<td style="text-align: right;">56038</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>RD</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>AVE</td>
<td>HWY</td>
</tr>
<tr class="even">
<td>Civic City Name</td>
<td>:string</td>
<td style="text-align: right;">552342</td>
<td style="text-align: right;">892</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>HALIFAX</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>HALIFAX</td>
<td>COOKVILLE</td>
</tr>
<tr class="odd">
<td>Sale Price</td>
<td>:int32</td>
<td style="text-align: right;">550742</td>
<td style="text-align: right;">2492</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">216081.15903999</td>
<td></td>
<td style="text-align: right;">3.70000000E+08</td>
<td style="text-align: right;">2006809.13640543</td>
<td style="text-align: right;">89.31325733</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>Sale Date</td>
<td>:string</td>
<td style="text-align: right;">553234</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>September 28 2012</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>January 08 2021</td>
<td>April 26 2024</td>
</tr>
<tr class="odd">
<td>Parcels In Sale</td>
<td>:int16</td>
<td style="text-align: right;">545757</td>
<td style="text-align: right;">7477</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">1.89112554</td>
<td></td>
<td style="text-align: right;">1.30000000E+02</td>
<td style="text-align: right;">3.23739061</td>
<td style="text-align: right;">15.40358232</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>Y Map Coordinate</td>
<td>:float64</td>
<td style="text-align: right;">526436</td>
<td style="text-align: right;">26798</td>
<td style="text-align: right;">43.398415</td>
<td style="text-align: right;">45.03052545</td>
<td></td>
<td style="text-align: right;">4.70250420E+01</td>
<td style="text-align: right;">0.67659690</td>
<td style="text-align: right;">0.20517924</td>
<td>44.65</td>
<td>44.41</td>
</tr>
<tr class="odd">
<td>X Map Coordinate</td>
<td>:float64</td>
<td style="text-align: right;">526436</td>
<td style="text-align: right;">26798</td>
<td style="text-align: right;">-66.392040</td>
<td style="text-align: right;">-63.44632344</td>
<td></td>
<td style="text-align: right;">-5.96961680E+01</td>
<td style="text-align: right;">1.60085428</td>
<td style="text-align: right;">0.61790586</td>
<td>-63.64</td>
<td>-64.55</td>
</tr>
<tr class="even">
<td>Map Coordinates</td>
<td>:string</td>
<td style="text-align: right;">526436</td>
<td style="text-align: right;">26798</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>(44.651645, -63.639508)</td>
<td>(44.413596, -64.552656)</td>
</tr>
</tbody>
</table>
</div>
<p>The column names are capitalized strings, which is fine but it’s easier and idiomatic to work with kebab-cased keywords as column-names in Clojure, so we’ll update our import to transform them on load. We can use the <code>to-clean-keyword</code> helper from <code>tcutils</code> to do this. It’s similar to the <a href="https://rdrr.io/cran/janitor/src/R/make_clean_names.R"><code>make_clean_names</code></a> helper from R’s <code>janitor</code> package, which is commonly used when datasets are loaded to, well, clean up the column names. You can see the full implementation <a href="https://github.com/scicloj/tcutils/blob/a7604cb6db3553546e974f2bb9733bb98b293d39/src/scicloj/tcutils/strings.clj#L31">here</a>, but basically it removes any non-ASCII characters in strings, and then kebab-case and keywordizes them.</p>
<p>Tablecloth also gives each dataset a name, which defaults to the file name. We’ll set ours to something more succinct here:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb3"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> sales-history</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  (tc/dataset <span class="st">"data/end_to_end/parcel_sales_history.csv"</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>              {<span class="at">:key-fn</span> tcustr/to-clean-keyword</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">:dataset-name</span> <span class="st">"sales-history"</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb4"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>(tc/info sales-history)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>sales-history: descriptive-stats [14 12]:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 14%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>:col-name</th>
<th>:datatype</th>
<th style="text-align: right;">:n-valid</th>
<th style="text-align: right;">:n-missing</th>
<th style="text-align: right;">:min</th>
<th style="text-align: right;">:mean</th>
<th>:mode</th>
<th style="text-align: right;">:max</th>
<th style="text-align: right;">:standard-deviation</th>
<th style="text-align: right;">:skew</th>
<th>:first</th>
<th>:last</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:municipal-unit</td>
<td>:string</td>
<td style="text-align: right;">553234</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
</tr>
<tr class="even">
<td>:assessment-account-number</td>
<td>:int32</td>
<td style="text-align: right;">553234</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">396.000000</td>
<td style="text-align: right;">5464364.27661351</td>
<td></td>
<td style="text-align: right;">1.10765560E+07</td>
<td style="text-align: right;">3559869.76102067</td>
<td style="text-align: right;">0.18744869</td>
<td>10587948</td>
<td>3933504</td>
</tr>
<tr class="odd">
<td>:civic-number</td>
<td>:int32</td>
<td style="text-align: right;">407909</td>
<td style="text-align: right;">145325</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">1249.59833198</td>
<td></td>
<td style="text-align: right;">5.19470000E+04</td>
<td style="text-align: right;">2989.77914396</td>
<td style="text-align: right;">6.12767133</td>
<td>75</td>
<td>918</td>
</tr>
<tr class="even">
<td>:civic-additional</td>
<td>:string</td>
<td style="text-align: right;">1365</td>
<td style="text-align: right;">551869</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>A</td>
<td></td>
</tr>
<tr class="odd">
<td>:civic-direction</td>
<td>:string</td>
<td style="text-align: right;">2224</td>
<td style="text-align: right;">551010</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>:civic-street-name</td>
<td>:string</td>
<td style="text-align: right;">550304</td>
<td style="text-align: right;">2930</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>HIGHWAY 1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>CENTRAL</td>
<td>NO 10</td>
</tr>
<tr class="odd">
<td>:civic-suffix</td>
<td>:string</td>
<td style="text-align: right;">497196</td>
<td style="text-align: right;">56038</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>RD</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>AVE</td>
<td>HWY</td>
</tr>
<tr class="even">
<td>:civic-city-name</td>
<td>:string</td>
<td style="text-align: right;">552342</td>
<td style="text-align: right;">892</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>HALIFAX</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>HALIFAX</td>
<td>COOKVILLE</td>
</tr>
<tr class="odd">
<td>:sale-price</td>
<td>:int32</td>
<td style="text-align: right;">550742</td>
<td style="text-align: right;">2492</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">216081.15903999</td>
<td></td>
<td style="text-align: right;">3.70000000E+08</td>
<td style="text-align: right;">2006809.13640543</td>
<td style="text-align: right;">89.31325733</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>:sale-date</td>
<td>:string</td>
<td style="text-align: right;">553234</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>September 28 2012</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>January 08 2021</td>
<td>April 26 2024</td>
</tr>
<tr class="odd">
<td>:parcels-in-sale</td>
<td>:int16</td>
<td style="text-align: right;">545757</td>
<td style="text-align: right;">7477</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">1.89112554</td>
<td></td>
<td style="text-align: right;">1.30000000E+02</td>
<td style="text-align: right;">3.23739061</td>
<td style="text-align: right;">15.40358232</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>:y-map-coordinate</td>
<td>:float64</td>
<td style="text-align: right;">526436</td>
<td style="text-align: right;">26798</td>
<td style="text-align: right;">43.398415</td>
<td style="text-align: right;">45.03052545</td>
<td></td>
<td style="text-align: right;">4.70250420E+01</td>
<td style="text-align: right;">0.67659690</td>
<td style="text-align: right;">0.20517924</td>
<td>44.65</td>
<td>44.41</td>
</tr>
<tr class="odd">
<td>:x-map-coordinate</td>
<td>:float64</td>
<td style="text-align: right;">526436</td>
<td style="text-align: right;">26798</td>
<td style="text-align: right;">-66.392040</td>
<td style="text-align: right;">-63.44632344</td>
<td></td>
<td style="text-align: right;">-5.96961680E+01</td>
<td style="text-align: right;">1.60085428</td>
<td style="text-align: right;">0.61790586</td>
<td>-63.64</td>
<td>-64.55</td>
</tr>
<tr class="even">
<td>:map-coordinates</td>
<td>:string</td>
<td style="text-align: right;">526436</td>
<td style="text-align: right;">26798</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>(44.651645, -63.639508)</td>
<td>(44.413596, -64.552656)</td>
</tr>
</tbody>
</table>
</div>
<p>Here we can see that this dataset includes information about the sale of the house (e.g.&nbsp;address, sale date, sale price, etc), but no features of the house itself (e.g.&nbsp;number of bedrooms, bathrooms, garages, etc.). We could build a model that predicts sale price based solely on a house’s location, but basic common sense tells us there’s more that goes into the value of the home. It’s not obvious exactly what the biggest determinants of price are, but anyone who has shopped for a house before knows that things like the age of the home, its size and features matter. To get this information, we’ll need a second dataset: <a href="https://www.thedatazone.ca/Assessment/Residential-Dwelling-Characteristics/a859-xvcs/about_data">Residential Dwelling Characteristics</a>.</p>
<p>We can load it the same way:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb5"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> characteristics</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  (tc/dataset <span class="st">"data/end_to_end/residential_dwelling_characteristics.csv"</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>              {<span class="at">:key-fn</span> tcustr/to-clean-keyword</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">:dataset-name</span> <span class="st">"characteristics"</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Upon inspection we can see that this dataset includes the information about houses that we’re looking for, and it also as a column for “Assessment Account Number”, which we should be able to use to join it up to our other one.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb6"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>(tc/info characteristics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>characteristics: descriptive-stats [21 12]:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 14%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 15%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>:col-name</th>
<th>:datatype</th>
<th style="text-align: right;">:n-valid</th>
<th style="text-align: right;">:n-missing</th>
<th style="text-align: right;">:min</th>
<th style="text-align: right;">:mean</th>
<th>:mode</th>
<th style="text-align: right;">:max</th>
<th style="text-align: right;">:standard-deviation</th>
<th style="text-align: right;">:skew</th>
<th>:first</th>
<th>:last</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:municipal-unit</td>
<td>:string</td>
<td style="text-align: right;">379101</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>MUNICIPALITY OF THE DISTRICT OF CLARE</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
</tr>
<tr class="even">
<td>:assessment-account-number</td>
<td>:int32</td>
<td style="text-align: right;">379101</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">485.000000</td>
<td style="text-align: right;">4599930.15107056</td>
<td></td>
<td style="text-align: right;">1.10765990E+07</td>
<td style="text-align: right;">3141825.67393673</td>
<td style="text-align: right;">0.49704026</td>
<td>1286048</td>
<td>5728266</td>
</tr>
<tr class="odd">
<td>:civic-number</td>
<td>:int32</td>
<td style="text-align: right;">374134</td>
<td style="text-align: right;">4967</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">1245.77175825</td>
<td></td>
<td style="text-align: right;">9.05984000E+05</td>
<td style="text-align: right;">3355.53596798</td>
<td style="text-align: right;">56.94117266</td>
<td>358</td>
<td>20</td>
</tr>
<tr class="even">
<td>:civic-additional</td>
<td>:string</td>
<td style="text-align: right;">1179</td>
<td style="text-align: right;">377922</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>:civic-direction</td>
<td>:string</td>
<td style="text-align: right;">1341</td>
<td style="text-align: right;">377760</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>:civic-street-name</td>
<td>:string</td>
<td style="text-align: right;">378551</td>
<td style="text-align: right;">550</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>HIGHWAY 1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>LITTLE BROOK</td>
<td>RITCEY</td>
</tr>
<tr class="odd">
<td>:civic-street-suffix</td>
<td>:string</td>
<td style="text-align: right;">338432</td>
<td style="text-align: right;">40669</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>RD</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>RD</td>
<td>CRT</td>
</tr>
<tr class="even">
<td>:civic-city-name</td>
<td>:string</td>
<td style="text-align: right;">378609</td>
<td style="text-align: right;">492</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>HALIFAX</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>LITTLE BROOK STATION</td>
<td>PORTERS LAKE</td>
</tr>
<tr class="odd">
<td>:living-units</td>
<td>:int16</td>
<td style="text-align: right;">379101</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">1.19882828</td>
<td></td>
<td style="text-align: right;">5.71000000E+02</td>
<td style="text-align: right;">7.17163974</td>
<td style="text-align: right;">66.61425743</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>:year-built</td>
<td>:int16</td>
<td style="text-align: right;">329438</td>
<td style="text-align: right;">49663</td>
<td style="text-align: right;">200.000000</td>
<td style="text-align: right;">1978.24914551</td>
<td></td>
<td style="text-align: right;">2.04800000E+03</td>
<td style="text-align: right;">29.17932661</td>
<td style="text-align: right;">-2.12051956</td>
<td>1976</td>
<td>1985</td>
</tr>
<tr class="odd">
<td>:square-foot-living-area</td>
<td>:int16</td>
<td style="text-align: right;">366348</td>
<td style="text-align: right;">12753</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">1537.18592977</td>
<td></td>
<td style="text-align: right;">2.39310000E+04</td>
<td style="text-align: right;">750.57258849</td>
<td style="text-align: right;">1.95137428</td>
<td>2392</td>
<td>2338</td>
</tr>
<tr class="even">
<td>:style</td>
<td>:string</td>
<td style="text-align: right;">366445</td>
<td style="text-align: right;">12656</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>1 Storey</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>2 Storey</td>
<td>1.5 Storey</td>
</tr>
<tr class="odd">
<td>:bedrooms</td>
<td>:int16</td>
<td style="text-align: right;">326866</td>
<td style="text-align: right;">52235</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">3.01704368</td>
<td></td>
<td style="text-align: right;">2.40000000E+01</td>
<td style="text-align: right;">1.02378973</td>
<td style="text-align: right;">1.33747502</td>
<td>4</td>
<td>4</td>
</tr>
<tr class="even">
<td>:bathrooms</td>
<td>:int16</td>
<td style="text-align: right;">379101</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">1.68568007</td>
<td></td>
<td style="text-align: right;">2.50000000E+01</td>
<td style="text-align: right;">0.95784940</td>
<td style="text-align: right;">1.28420156</td>
<td>2</td>
<td>4</td>
</tr>
<tr class="odd">
<td>:under-construction</td>
<td>:string</td>
<td style="text-align: right;">379101</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>N</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>N</td>
<td>N</td>
</tr>
<tr class="even">
<td>:construction-grade</td>
<td>:string</td>
<td style="text-align: right;">366269</td>
<td style="text-align: right;">12832</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>Average</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>Average</td>
<td>Average</td>
</tr>
<tr class="odd">
<td>:finished-basement</td>
<td>:string</td>
<td style="text-align: right;">379101</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>N</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>N</td>
<td>Y</td>
</tr>
<tr class="even">
<td>:garage</td>
<td>:string</td>
<td style="text-align: right;">379101</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>N</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>N</td>
<td>Y</td>
</tr>
<tr class="odd">
<td>:y-map-coordinate</td>
<td>:float64</td>
<td style="text-align: right;">354986</td>
<td style="text-align: right;">24115</td>
<td style="text-align: right;">43.398415</td>
<td style="text-align: right;">45.04529417</td>
<td></td>
<td style="text-align: right;">4.70260480E+01</td>
<td style="text-align: right;">0.66341981</td>
<td style="text-align: right;">0.29089356</td>
<td>44.29</td>
<td>44.74</td>
</tr>
<tr class="even">
<td>:x-map-coordinate</td>
<td>:float64</td>
<td style="text-align: right;">354986</td>
<td style="text-align: right;">24115</td>
<td style="text-align: right;">-66.387871</td>
<td style="text-align: right;">-63.36304830</td>
<td></td>
<td style="text-align: right;">-5.97949100E+01</td>
<td style="text-align: right;">1.56388011</td>
<td style="text-align: right;">0.69450136</td>
<td>-66.10</td>
<td>-63.30</td>
</tr>
<tr class="odd">
<td>:map-coordinates</td>
<td>:string</td>
<td style="text-align: right;">354986</td>
<td style="text-align: right;">24115</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>(44.293843, -66.10439)</td>
<td>(44.743576, -63.302604)</td>
</tr>
</tbody>
</table>
</div>
<p>There’s one other piece of information that I want for our model. In Nova Scotia, it’s not uncommon to own relatively large plots of land, and this can make house prices seem surprising. A small or very old house might seem like it’s priced too high, for example, if you don’t notice the size of the lot that it’s on. We can get this information, again indexed by the Assessment Account Number, from the <a href="https://www.thedatazone.ca/Assessment/Parcel-Land-Sizes/wg22-3ric/about_data">Parcel Land Sizes</a> dataset:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb7"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> land-sizes</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  (tc/dataset <span class="st">"data/end_to_end/parcel_land_sizes.csv"</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>              {<span class="at">:key-fn</span> tcustr/to-clean-keyword</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">:dataset-name</span> <span class="st">"land-sizes"</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb8"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>(tc/info land-sizes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>land-sizes: descriptive-stats [13 12]:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 14%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 14%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th>:col-name</th>
<th>:datatype</th>
<th style="text-align: right;">:n-valid</th>
<th style="text-align: right;">:n-missing</th>
<th style="text-align: right;">:min</th>
<th style="text-align: right;">:mean</th>
<th>:mode</th>
<th style="text-align: right;">:max</th>
<th style="text-align: right;">:standard-deviation</th>
<th style="text-align: right;">:skew</th>
<th>:first</th>
<th>:last</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:municipal-unit</td>
<td>:string</td>
<td style="text-align: right;">647472</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
</tr>
<tr class="even">
<td>:assessment-account-number</td>
<td>:int32</td>
<td style="text-align: right;">647472</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">35.000000</td>
<td style="text-align: right;">5327202.15206990</td>
<td></td>
<td style="text-align: right;">1.10797510E+07</td>
<td style="text-align: right;">3.46299091E+06</td>
<td style="text-align: right;">0.22692123</td>
<td>911593</td>
<td>11000738</td>
</tr>
<tr class="odd">
<td>:civic-number</td>
<td>:int32</td>
<td style="text-align: right;">436880</td>
<td style="text-align: right;">210592</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">1299.84449734</td>
<td></td>
<td style="text-align: right;">9.05984000E+05</td>
<td style="text-align: right;">3.38721369E+03</td>
<td style="text-align: right;">48.31175816</td>
<td>445</td>
<td></td>
</tr>
<tr class="even">
<td>:civic-additional</td>
<td>:string</td>
<td style="text-align: right;">1462</td>
<td style="text-align: right;">646010</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>:civic-direction</td>
<td>:string</td>
<td style="text-align: right;">2603</td>
<td style="text-align: right;">644869</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>:civic-street-name</td>
<td>:string</td>
<td style="text-align: right;">638079</td>
<td style="text-align: right;">9393</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>WEST PORTERS LAKE</td>
<td>SOUTH RAWDON</td>
</tr>
<tr class="odd">
<td>:civic-street-suffix</td>
<td>:string</td>
<td style="text-align: right;">574720</td>
<td style="text-align: right;">72752</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>RD</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>RD</td>
<td>RD</td>
</tr>
<tr class="even">
<td>:civic-city-name</td>
<td>:string</td>
<td style="text-align: right;">643321</td>
<td style="text-align: right;">4151</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>HALIFAX</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>PORTERS LAKE</td>
<td>HILLSVALE</td>
</tr>
<tr class="odd">
<td>:acreage</td>
<td>:float64</td>
<td style="text-align: right;">644235</td>
<td style="text-align: right;">3237</td>
<td style="text-align: right;">-80.010000</td>
<td style="text-align: right;">22.77548066</td>
<td></td>
<td style="text-align: right;">3.23921000E+05</td>
<td style="text-align: right;">8.40222965E+02</td>
<td style="text-align: right;">177.93796144</td>
<td>2.470</td>
<td>1.850</td>
</tr>
<tr class="even">
<td>:square-feet</td>
<td>:int64</td>
<td style="text-align: right;">606490</td>
<td style="text-align: right;">40982</td>
<td style="text-align: right;">-1056000.000000</td>
<td style="text-align: right;">951048.04373197</td>
<td></td>
<td style="text-align: right;">8.15726340E+09</td>
<td style="text-align: right;">3.05072574E+07</td>
<td style="text-align: right;">143.20927713</td>
<td>107680</td>
<td>80642</td>
</tr>
<tr class="odd">
<td>:y-map-coordinate</td>
<td>:float64</td>
<td style="text-align: right;">604633</td>
<td style="text-align: right;">42839</td>
<td style="text-align: right;">43.391144</td>
<td style="text-align: right;">45.07207757</td>
<td></td>
<td style="text-align: right;">4.72261700E+01</td>
<td style="text-align: right;">6.97087997E-01</td>
<td style="text-align: right;">0.11462748</td>
<td>44.72</td>
<td></td>
</tr>
<tr class="even">
<td>:x-map-coordinate</td>
<td>:float64</td>
<td style="text-align: right;">604633</td>
<td style="text-align: right;">42839</td>
<td style="text-align: right;">-66.392040</td>
<td style="text-align: right;">-63.35237711</td>
<td></td>
<td style="text-align: right;">-5.96961680E+01</td>
<td style="text-align: right;">1.66378362E+00</td>
<td style="text-align: right;">0.51926351</td>
<td>-63.31</td>
<td></td>
</tr>
<tr class="odd">
<td>:map-coordinates</td>
<td>:string</td>
<td style="text-align: right;">604633</td>
<td style="text-align: right;">42839</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>(44.719344, -63.308412)</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>Since loading the data is so easy here, we’ll take a moment to introduce tablecloth. <a href="https://github.com/scicloj/tablecloth">Tablecloth</a> is the main data manipulation library in the Clojure data science ecosystem. It provides a dataframe-like abstraction for working with data and similar operations to those found in popular data analysis libraries in other languages, like pandas in Python or dplyr in R. It provides a familiar interface for data scientists used to working with tabular data in other ecosystems while leveraging Clojure’s strengths in functional programming and immutability. It’s built on top of <a href="https://github.com/techascent/tech.ml.dataset">tech.ml.dataset</a>, Clojure’s main library for high-performance data processing.</p>
<dl>
<dt>We’ll use tablecloth throughout the rest of this section to clean up our data.</dt>
<dd>
<p>We want a single dataset that contains only information relevant to building our model. Right now the relevant information is spread across our three datasets. To see what information we care about, first we can inspect the column names from each dataset:</p>
</dd>
</dl>
<div class="sourceClojure">
<div class="sourceCode" id="cb9"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(tc/column-names sales-history)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb10"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:municipal-unit</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:assessment-account-number</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:civic-number</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:civic-additional</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:civic-direction</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:civic-street-name</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:civic-suffix</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:civic-city-name</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:sale-price</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:sale-date</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:parcels-in-sale</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a> <span class="at">:y-map-coordinate</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a> <span class="at">:x-map-coordinate</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a> <span class="at">:map-coordinates</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb11"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(tc/column-names characteristics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb12"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:municipal-unit</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:assessment-account-number</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:civic-number</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:civic-additional</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:civic-direction</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:civic-street-name</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:civic-street-suffix</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:civic-city-name</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:living-units</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:year-built</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:square-foot-living-area</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a> <span class="at">:style</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a> <span class="at">:bedrooms</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a> <span class="at">:bathrooms</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a> <span class="at">:under-construction</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a> <span class="at">:construction-grade</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a> <span class="at">:finished-basement</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a> <span class="at">:garage</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a> <span class="at">:y-map-coordinate</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a> <span class="at">:x-map-coordinate</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a> <span class="at">:map-coordinates</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb13"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>(tc/column-names land-sizes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb14"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:municipal-unit</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:assessment-account-number</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:civic-number</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:civic-additional</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:civic-direction</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:civic-street-name</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:civic-street-suffix</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:civic-city-name</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:acreage</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:square-feet</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:y-map-coordinate</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a> <span class="at">:x-map-coordinate</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a> <span class="at">:map-coordinates</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are methods we can use to determine which features are most relevant for our target, but for now we can use common sense to omit a few, like the map coordinates. We’ll use tablecloth to join all the datasets together by assessment account number:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb15"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> housing-data</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">-&gt;</span> sales-history</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>      (tc/select-columns [<span class="at">:assessment-account-number</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">:municipal-unit</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">:civic-number</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">:civic-additional</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">:civic-direction</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">:civic-street-name</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">:civic-suffix</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">:civic-city-name</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">:sale-price</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">:sale-date</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">:parcels-in-sale</span>])</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>      (tc/inner-join (tc/select-columns characteristics</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>                                        [<span class="at">:assessment-account-number</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">:living-units</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">:year-built</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">:square-foot-living-area</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">:style</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">:bedrooms</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">:bathrooms</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">:under-construction</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">:construction-grade</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">:finished-basement</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">:garage</span>])</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">:assessment-account-number</span>)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>      (tc/inner-join (tc/select-columns land-sizes</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>                                        [<span class="at">:assessment-account-number</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">:square-feet</span>])</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">:assessment-account-number</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we have a single, combined dataset to work with. We’ll do some basic data cleaning and integrity checks before saving it to work with in the next steps.</p>
<section id="data-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning">Data cleaning</h2>
<section id="correcting-datatypes" class="level3">
<h3 class="anchored" data-anchor-id="correcting-datatypes">Correcting datatypes</h3>
<p>First, we can check that the datatypes of each column make sense:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb16"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> housing-data</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    tc/info</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns [<span class="at">:col-name</span> <span class="at">:datatype</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>inner-join: descriptive-stats [22 2]:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>:col-name</th>
<th>:datatype</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:assessment-account-number</td>
<td>:int32</td>
</tr>
<tr class="even">
<td>:municipal-unit</td>
<td>:string</td>
</tr>
<tr class="odd">
<td>:civic-number</td>
<td>:int32</td>
</tr>
<tr class="even">
<td>:civic-additional</td>
<td>:string</td>
</tr>
<tr class="odd">
<td>:civic-direction</td>
<td>:string</td>
</tr>
<tr class="even">
<td>:civic-street-name</td>
<td>:string</td>
</tr>
<tr class="odd">
<td>:civic-suffix</td>
<td>:string</td>
</tr>
<tr class="even">
<td>:civic-city-name</td>
<td>:string</td>
</tr>
<tr class="odd">
<td>:sale-price</td>
<td>:int32</td>
</tr>
<tr class="even">
<td>:sale-date</td>
<td>:string</td>
</tr>
<tr class="odd">
<td>:parcels-in-sale</td>
<td>:int16</td>
</tr>
<tr class="even">
<td>:living-units</td>
<td>:int16</td>
</tr>
<tr class="odd">
<td>:year-built</td>
<td>:int16</td>
</tr>
<tr class="even">
<td>:square-foot-living-area</td>
<td>:int16</td>
</tr>
<tr class="odd">
<td>:style</td>
<td>:string</td>
</tr>
<tr class="even">
<td>:bedrooms</td>
<td>:int16</td>
</tr>
<tr class="odd">
<td>:bathrooms</td>
<td>:int16</td>
</tr>
<tr class="even">
<td>:under-construction</td>
<td>:string</td>
</tr>
<tr class="odd">
<td>:construction-grade</td>
<td>:string</td>
</tr>
<tr class="even">
<td>:finished-basement</td>
<td>:string</td>
</tr>
<tr class="odd">
<td>:garage</td>
<td>:string</td>
</tr>
<tr class="even">
<td>:square-feet</td>
<td>:int64</td>
</tr>
</tbody>
</table>
</div>
<p>These mostly look good except for <code>:sale-date</code>, which should probably be either a number (if it’s a year) or some date format. We’ll also double check some of the string columns to make sure their values are coherent.</p>
<p>First, inspecting the <code>:sale-date</code> column:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb17"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:sale-date</span> housing-data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb18"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&lt;string&gt;[<span class="dv">363075</span>]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="at">:sale-date</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>[June <span class="dv">28</span> <span class="dv">2018</span>, July <span class="dv">22</span> <span class="dv">2022</span>, January <span class="dv">19</span> <span class="dv">2023</span>, June <span class="dv">28</span> <span class="dv">2022</span>, August <span class="dv">29</span> <span class="dv">2019</span>, October <span class="dv">09</span> <span class="dv">2020</span>, February <span class="dv">10</span> <span class="dv">2023</span>, June <span class="dv">13</span> <span class="dv">2023</span>, September <span class="dv">24</span> <span class="dv">2020</span>, October <span class="dv">08</span> <span class="dv">2020</span>, January <span class="dv">09</span> <span class="dv">2017</span>, May <span class="dv">11</span> <span class="dv">2018</span>, August <span class="dv">31</span> <span class="dv">2022</span>, October <span class="dv">15</span> <span class="dv">2020</span>, November <span class="dv">01</span> <span class="dv">2021</span>, July <span class="dv">16</span> <span class="dv">2013</span>, September <span class="dv">25</span> <span class="dv">2014</span>, September <span class="dv">25</span> <span class="dv">2014</span>, July <span class="dv">02</span> <span class="dv">2019</span>, March <span class="dv">10</span> <span class="dv">2022</span>...]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can see it’s strings that should be full dates. Tablecloth makes it easy to parse the strings into a supported date format. First we’ll define a helper to parse these strings as dates using some of Java’s time utils:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb19"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> date-format </span>(DateTimeFormatter/ofPattern <span class="st">"MMMM dd yyyy"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb20"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn-</span><span class="fu"> to-date </span>[s]</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  (LocalDate/parse s date-format))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb21"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="va">#'book.part-0-end-to-end.1-data-import-and-cleanup-example/to-date</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then use tablecloth’s <code>convert-types</code> to efficiently process the whole column:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb22"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> housing-data</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    (tc/convert-types <span class="at">:sale-date</span> [[<span class="at">:packed-local-date</span> to-date]]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>inner-join [363075 22]:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 2%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">:assessment-account-number</th>
<th>:municipal-unit</th>
<th style="text-align: right;">:civic-number</th>
<th>:civic-additional</th>
<th>:civic-direction</th>
<th>:civic-street-name</th>
<th>:civic-suffix</th>
<th>:civic-city-name</th>
<th style="text-align: right;">:sale-price</th>
<th>:sale-date</th>
<th style="text-align: right;">:parcels-in-sale</th>
<th style="text-align: right;">:living-units</th>
<th style="text-align: right;">:year-built</th>
<th style="text-align: right;">:square-foot-living-area</th>
<th>:style</th>
<th style="text-align: right;">:bedrooms</th>
<th style="text-align: right;">:bathrooms</th>
<th>:under-construction</th>
<th>:construction-grade</th>
<th>:finished-basement</th>
<th>:garage</th>
<th style="text-align: right;">:square-feet</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">911593</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">445</td>
<td></td>
<td></td>
<td>WEST PORTERS LAKE</td>
<td>RD</td>
<td>PORTERS LAKE</td>
<td style="text-align: right;">225000</td>
<td>2018-06-28</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1987</td>
<td style="text-align: right;">988</td>
<td>1 Storey</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">1</td>
<td>N</td>
<td>Average</td>
<td>N</td>
<td>N</td>
<td style="text-align: right;">107680</td>
</tr>
<tr class="even">
<td style="text-align: right;">911593</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">445</td>
<td></td>
<td></td>
<td>WEST PORTERS LAKE</td>
<td>RD</td>
<td>PORTERS LAKE</td>
<td style="text-align: right;">380000</td>
<td>2022-07-22</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1987</td>
<td style="text-align: right;">988</td>
<td>1 Storey</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">1</td>
<td>N</td>
<td>Average</td>
<td>N</td>
<td>N</td>
<td style="text-align: right;">107680</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8502838</td>
<td>MUNICIPALITY OF THE DISTRICT OF ARGYLE</td>
<td style="text-align: right;">1125</td>
<td></td>
<td></td>
<td>DU TITTLE</td>
<td>CH</td>
<td>SURETTES ISLAND</td>
<td style="text-align: right;">0</td>
<td>2023-01-19</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">640</td>
<td>2 Storey</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>N</td>
<td>Low</td>
<td>N</td>
<td>N</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">3698858</td>
<td>MUNICIPALITY OF THE COUNTY OF KINGS</td>
<td style="text-align: right;">9739</td>
<td></td>
<td></td>
<td>MAIN</td>
<td>ST</td>
<td>CANNING</td>
<td style="text-align: right;">130000</td>
<td>2022-06-28</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">1632</td>
<td>2 Storey</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td>Y</td>
<td>Average</td>
<td>N</td>
<td>N</td>
<td style="text-align: right;">7562</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3698858</td>
<td>MUNICIPALITY OF THE COUNTY OF KINGS</td>
<td style="text-align: right;">9739</td>
<td></td>
<td></td>
<td>MAIN</td>
<td>ST</td>
<td>CANNING</td>
<td style="text-align: right;">85000</td>
<td>2019-08-29</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">1632</td>
<td>2 Storey</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td>Y</td>
<td>Average</td>
<td>N</td>
<td>N</td>
<td style="text-align: right;">7562</td>
</tr>
<tr class="even">
<td style="text-align: right;">3944026</td>
<td>MUNI. OF THE DISTRICT OF GUYSBOROUGH</td>
<td style="text-align: right;">5231</td>
<td></td>
<td></td>
<td>HIGHWAY 316</td>
<td></td>
<td>CHARLOS COVE</td>
<td style="text-align: right;">8500</td>
<td>2020-10-09</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">340</td>
<td>1 Storey</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>N</td>
<td>Low</td>
<td>N</td>
<td>N</td>
<td style="text-align: right;">5400</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3944026</td>
<td>MUNI. OF THE DISTRICT OF GUYSBOROUGH</td>
<td style="text-align: right;">5231</td>
<td></td>
<td></td>
<td>HIGHWAY 316</td>
<td></td>
<td>CHARLOS COVE</td>
<td style="text-align: right;">0</td>
<td>2023-02-10</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">340</td>
<td>1 Storey</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>N</td>
<td>Low</td>
<td>N</td>
<td>N</td>
<td style="text-align: right;">5400</td>
</tr>
<tr class="even">
<td style="text-align: right;">3944026</td>
<td>MUNI. OF THE DISTRICT OF GUYSBOROUGH</td>
<td style="text-align: right;">5231</td>
<td></td>
<td></td>
<td>HIGHWAY 316</td>
<td></td>
<td>CHARLOS COVE</td>
<td style="text-align: right;">0</td>
<td>2023-06-13</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">340</td>
<td>1 Storey</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>N</td>
<td>Low</td>
<td>N</td>
<td>N</td>
<td style="text-align: right;">5400</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3885003</td>
<td>MUNICIPALITY OF THE COUNTY OF INVERNESS</td>
<td style="text-align: right;">1394</td>
<td></td>
<td></td>
<td>MABOU HARBOUR</td>
<td>RD</td>
<td>MABOU HARBOUR</td>
<td style="text-align: right;">0</td>
<td>2020-09-24</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1910</td>
<td style="text-align: right;">1170</td>
<td>1.5 Storey</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td>N</td>
<td>Average</td>
<td>N</td>
<td>N</td>
<td style="text-align: right;">1320304</td>
</tr>
<tr class="even">
<td style="text-align: right;">3885003</td>
<td>MUNICIPALITY OF THE COUNTY OF INVERNESS</td>
<td style="text-align: right;">1394</td>
<td></td>
<td></td>
<td>MABOU HARBOUR</td>
<td>RD</td>
<td>MABOU HARBOUR</td>
<td style="text-align: right;">0</td>
<td>2020-10-08</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1910</td>
<td style="text-align: right;">1170</td>
<td>1.5 Storey</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td>N</td>
<td>Average</td>
<td>N</td>
<td>N</td>
<td style="text-align: right;">1320304</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td style="text-align: right;">10863791</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td style="text-align: right;">320</td>
<td></td>
<td></td>
<td>EVELYN</td>
<td>DR</td>
<td>PARKDALE</td>
<td style="text-align: right;">90000</td>
<td>2021-02-26</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1106</td>
<td>1 Storey</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td>N</td>
<td>Average</td>
<td>Y</td>
<td>Y</td>
<td style="text-align: right;">118483</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2745755</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">1178</td>
<td></td>
<td></td>
<td>KETCH HARBOUR</td>
<td>RD</td>
<td>KETCH HARBOUR</td>
<td style="text-align: right;">42000</td>
<td>2015-06-30</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">1170</td>
<td>1.5 Storey</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>N</td>
<td>Average</td>
<td>N</td>
<td>Y</td>
<td style="text-align: right;">51687</td>
</tr>
<tr class="even">
<td style="text-align: right;">2745755</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">1178</td>
<td></td>
<td></td>
<td>KETCH HARBOUR</td>
<td>RD</td>
<td>KETCH HARBOUR</td>
<td style="text-align: right;">69000</td>
<td>2011-06-23</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">1170</td>
<td>1.5 Storey</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>N</td>
<td>Average</td>
<td>N</td>
<td>Y</td>
<td style="text-align: right;">51687</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2745755</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">1178</td>
<td></td>
<td></td>
<td>KETCH HARBOUR</td>
<td>RD</td>
<td>KETCH HARBOUR</td>
<td style="text-align: right;">591500</td>
<td>2021-12-22</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">1170</td>
<td>1.5 Storey</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>N</td>
<td>Average</td>
<td>N</td>
<td>Y</td>
<td style="text-align: right;">51687</td>
</tr>
<tr class="even">
<td style="text-align: right;">10751993</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>ARDOISE</td>
<td style="text-align: right;">44900</td>
<td>2022-04-29</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1230</td>
<td>1 Storey</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td>N</td>
<td>Average</td>
<td>N</td>
<td>N</td>
<td style="text-align: right;">48352</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10751993</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>ARDOISE</td>
<td style="text-align: right;">0</td>
<td>2018-10-25</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1230</td>
<td>1 Storey</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td>N</td>
<td>Average</td>
<td>N</td>
<td>N</td>
<td style="text-align: right;">48352</td>
</tr>
<tr class="even">
<td style="text-align: right;">10751993</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>ARDOISE</td>
<td style="text-align: right;">37000</td>
<td>2020-06-04</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1230</td>
<td>1 Storey</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td>N</td>
<td>Average</td>
<td>N</td>
<td>N</td>
<td style="text-align: right;">48352</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10751993</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>ARDOISE</td>
<td style="text-align: right;">51000</td>
<td>2021-07-19</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1230</td>
<td>1 Storey</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td>N</td>
<td>Average</td>
<td>N</td>
<td>N</td>
<td style="text-align: right;">48352</td>
</tr>
<tr class="even">
<td style="text-align: right;">7667817</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">56</td>
<td></td>
<td></td>
<td>LAKE</td>
<td>RD</td>
<td>PLEASANT VALLEY</td>
<td style="text-align: right;">0</td>
<td>2019-11-15</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1996</td>
<td style="text-align: right;">1050</td>
<td>1.5 Storey</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0</td>
<td>N</td>
<td>Low</td>
<td>N</td>
<td>N</td>
<td style="text-align: right;">332798</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10986400</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">538</td>
<td></td>
<td></td>
<td>MIDNIGHT</td>
<td>RUN</td>
<td>MIDDLE SACKVILLE</td>
<td style="text-align: right;">767575</td>
<td>2022-05-17</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">2412</td>
<td>Split Entry</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td>N</td>
<td>Good</td>
<td>Y</td>
<td>Y</td>
<td style="text-align: right;">143400</td>
</tr>
<tr class="even">
<td style="text-align: right;">10986400</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">538</td>
<td></td>
<td></td>
<td>MIDNIGHT</td>
<td>RUN</td>
<td>MIDDLE SACKVILLE</td>
<td style="text-align: right;">0</td>
<td>2022-01-31</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">2412</td>
<td>Split Entry</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td>N</td>
<td>Good</td>
<td>Y</td>
<td>Y</td>
<td style="text-align: right;">143400</td>
</tr>
</tbody>
</table>
</div>
<p>Now the sale date values can be worked with as dates, which is much better than strings. Next we’ll look at the remaining string columns (they’re always suspicious).</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb23"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> housing-data</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    (tc/convert-types <span class="at">:sale-date</span> [[<span class="at">:packed-local-date</span> to-date]])</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns <span class="at">:type/string</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>inner-join [363075 11]:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th>:municipal-unit</th>
<th>:civic-additional</th>
<th>:civic-direction</th>
<th>:civic-street-name</th>
<th>:civic-suffix</th>
<th>:civic-city-name</th>
<th>:style</th>
<th>:under-construction</th>
<th>:construction-grade</th>
<th>:finished-basement</th>
<th>:garage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td></td>
<td></td>
<td>WEST PORTERS LAKE</td>
<td>RD</td>
<td>PORTERS LAKE</td>
<td>1 Storey</td>
<td>N</td>
<td>Average</td>
<td>N</td>
<td>N</td>
</tr>
<tr class="even">
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td></td>
<td></td>
<td>WEST PORTERS LAKE</td>
<td>RD</td>
<td>PORTERS LAKE</td>
<td>1 Storey</td>
<td>N</td>
<td>Average</td>
<td>N</td>
<td>N</td>
</tr>
<tr class="odd">
<td>MUNICIPALITY OF THE DISTRICT OF ARGYLE</td>
<td></td>
<td></td>
<td>DU TITTLE</td>
<td>CH</td>
<td>SURETTES ISLAND</td>
<td>2 Storey</td>
<td>N</td>
<td>Low</td>
<td>N</td>
<td>N</td>
</tr>
<tr class="even">
<td>MUNICIPALITY OF THE COUNTY OF KINGS</td>
<td></td>
<td></td>
<td>MAIN</td>
<td>ST</td>
<td>CANNING</td>
<td>2 Storey</td>
<td>Y</td>
<td>Average</td>
<td>N</td>
<td>N</td>
</tr>
<tr class="odd">
<td>MUNICIPALITY OF THE COUNTY OF KINGS</td>
<td></td>
<td></td>
<td>MAIN</td>
<td>ST</td>
<td>CANNING</td>
<td>2 Storey</td>
<td>Y</td>
<td>Average</td>
<td>N</td>
<td>N</td>
</tr>
<tr class="even">
<td>MUNI. OF THE DISTRICT OF GUYSBOROUGH</td>
<td></td>
<td></td>
<td>HIGHWAY 316</td>
<td></td>
<td>CHARLOS COVE</td>
<td>1 Storey</td>
<td>N</td>
<td>Low</td>
<td>N</td>
<td>N</td>
</tr>
<tr class="odd">
<td>MUNI. OF THE DISTRICT OF GUYSBOROUGH</td>
<td></td>
<td></td>
<td>HIGHWAY 316</td>
<td></td>
<td>CHARLOS COVE</td>
<td>1 Storey</td>
<td>N</td>
<td>Low</td>
<td>N</td>
<td>N</td>
</tr>
<tr class="even">
<td>MUNI. OF THE DISTRICT OF GUYSBOROUGH</td>
<td></td>
<td></td>
<td>HIGHWAY 316</td>
<td></td>
<td>CHARLOS COVE</td>
<td>1 Storey</td>
<td>N</td>
<td>Low</td>
<td>N</td>
<td>N</td>
</tr>
<tr class="odd">
<td>MUNICIPALITY OF THE COUNTY OF INVERNESS</td>
<td></td>
<td></td>
<td>MABOU HARBOUR</td>
<td>RD</td>
<td>MABOU HARBOUR</td>
<td>1.5 Storey</td>
<td>N</td>
<td>Average</td>
<td>N</td>
<td>N</td>
</tr>
<tr class="even">
<td>MUNICIPALITY OF THE COUNTY OF INVERNESS</td>
<td></td>
<td></td>
<td>MABOU HARBOUR</td>
<td>RD</td>
<td>MABOU HARBOUR</td>
<td>1.5 Storey</td>
<td>N</td>
<td>Average</td>
<td>N</td>
<td>N</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td></td>
<td></td>
<td>EVELYN</td>
<td>DR</td>
<td>PARKDALE</td>
<td>1 Storey</td>
<td>N</td>
<td>Average</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="odd">
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td></td>
<td></td>
<td>KETCH HARBOUR</td>
<td>RD</td>
<td>KETCH HARBOUR</td>
<td>1.5 Storey</td>
<td>N</td>
<td>Average</td>
<td>N</td>
<td>Y</td>
</tr>
<tr class="even">
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td></td>
<td></td>
<td>KETCH HARBOUR</td>
<td>RD</td>
<td>KETCH HARBOUR</td>
<td>1.5 Storey</td>
<td>N</td>
<td>Average</td>
<td>N</td>
<td>Y</td>
</tr>
<tr class="odd">
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td></td>
<td></td>
<td>KETCH HARBOUR</td>
<td>RD</td>
<td>KETCH HARBOUR</td>
<td>1.5 Storey</td>
<td>N</td>
<td>Average</td>
<td>N</td>
<td>Y</td>
</tr>
<tr class="even">
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>ARDOISE</td>
<td>1 Storey</td>
<td>N</td>
<td>Average</td>
<td>N</td>
<td>N</td>
</tr>
<tr class="odd">
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>ARDOISE</td>
<td>1 Storey</td>
<td>N</td>
<td>Average</td>
<td>N</td>
<td>N</td>
</tr>
<tr class="even">
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>ARDOISE</td>
<td>1 Storey</td>
<td>N</td>
<td>Average</td>
<td>N</td>
<td>N</td>
</tr>
<tr class="odd">
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>ARDOISE</td>
<td>1 Storey</td>
<td>N</td>
<td>Average</td>
<td>N</td>
<td>N</td>
</tr>
<tr class="even">
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td></td>
<td></td>
<td>LAKE</td>
<td>RD</td>
<td>PLEASANT VALLEY</td>
<td>1.5 Storey</td>
<td>N</td>
<td>Low</td>
<td>N</td>
<td>N</td>
</tr>
<tr class="odd">
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td></td>
<td></td>
<td>MIDNIGHT</td>
<td>RUN</td>
<td>MIDDLE SACKVILLE</td>
<td>Split Entry</td>
<td>N</td>
<td>Good</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="even">
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td></td>
<td></td>
<td>MIDNIGHT</td>
<td>RUN</td>
<td>MIDDLE SACKVILLE</td>
<td>Split Entry</td>
<td>N</td>
<td>Good</td>
<td>Y</td>
<td>Y</td>
</tr>
</tbody>
</table>
</div>
<p>All of the civic address columns are fine; we won’t use those in our model anyway. Some of the other ones – <code>:under-construction</code>, <code>:finished-basement</code>, and <code>:garage</code> – are boolean columns that use “Y”/“N” right now, which is ok. It’s clear and human readable, but we can easily convert these values to actual booleans, which are equally compact and human readable but more machine-friendly. This also has the added benefit of ensuring there are no bogus values, since each value must be only either <code>true</code> or <code>false</code>. Booleans are one of a <a href="https://github.com/techascent/tech.ml.dataset/blob/7dbda7ab2923521d298c1be3d257b3563b4f1efc/src/tech/v3/dataset/io/column_parsers.clj#L53">few datatypes that have a built-in coercer</a>, so we don’t need to write any special helpers to do it ourselves. We can add this to our previous type conversion using the syntax for multiple transformations:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb24"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> housing-data</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    (tc/convert-types {<span class="at">:sale-date</span> [<span class="at">:packed-local-date</span> to-date]</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">:under-construction</span> <span class="at">:boolean</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">:finished-basement</span> <span class="at">:boolean</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">:garage</span> <span class="at">:boolean</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>inner-join [363075 22]:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 2%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">:assessment-account-number</th>
<th>:municipal-unit</th>
<th style="text-align: right;">:civic-number</th>
<th>:civic-additional</th>
<th>:civic-direction</th>
<th>:civic-street-name</th>
<th>:civic-suffix</th>
<th>:civic-city-name</th>
<th style="text-align: right;">:sale-price</th>
<th>:sale-date</th>
<th style="text-align: right;">:parcels-in-sale</th>
<th style="text-align: right;">:living-units</th>
<th style="text-align: right;">:year-built</th>
<th style="text-align: right;">:square-foot-living-area</th>
<th>:style</th>
<th style="text-align: right;">:bedrooms</th>
<th style="text-align: right;">:bathrooms</th>
<th>:under-construction</th>
<th>:construction-grade</th>
<th>:finished-basement</th>
<th>:garage</th>
<th style="text-align: right;">:square-feet</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">911593</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">445</td>
<td></td>
<td></td>
<td>WEST PORTERS LAKE</td>
<td>RD</td>
<td>PORTERS LAKE</td>
<td style="text-align: right;">225000</td>
<td>2018-06-28</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1987</td>
<td style="text-align: right;">988</td>
<td>1 Storey</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">107680</td>
</tr>
<tr class="even">
<td style="text-align: right;">911593</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">445</td>
<td></td>
<td></td>
<td>WEST PORTERS LAKE</td>
<td>RD</td>
<td>PORTERS LAKE</td>
<td style="text-align: right;">380000</td>
<td>2022-07-22</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1987</td>
<td style="text-align: right;">988</td>
<td>1 Storey</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">107680</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8502838</td>
<td>MUNICIPALITY OF THE DISTRICT OF ARGYLE</td>
<td style="text-align: right;">1125</td>
<td></td>
<td></td>
<td>DU TITTLE</td>
<td>CH</td>
<td>SURETTES ISLAND</td>
<td style="text-align: right;">0</td>
<td>2023-01-19</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">640</td>
<td>2 Storey</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>false</td>
<td>Low</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">3698858</td>
<td>MUNICIPALITY OF THE COUNTY OF KINGS</td>
<td style="text-align: right;">9739</td>
<td></td>
<td></td>
<td>MAIN</td>
<td>ST</td>
<td>CANNING</td>
<td style="text-align: right;">130000</td>
<td>2022-06-28</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">1632</td>
<td>2 Storey</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td>true</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">7562</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3698858</td>
<td>MUNICIPALITY OF THE COUNTY OF KINGS</td>
<td style="text-align: right;">9739</td>
<td></td>
<td></td>
<td>MAIN</td>
<td>ST</td>
<td>CANNING</td>
<td style="text-align: right;">85000</td>
<td>2019-08-29</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">1632</td>
<td>2 Storey</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td>true</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">7562</td>
</tr>
<tr class="even">
<td style="text-align: right;">3944026</td>
<td>MUNI. OF THE DISTRICT OF GUYSBOROUGH</td>
<td style="text-align: right;">5231</td>
<td></td>
<td></td>
<td>HIGHWAY 316</td>
<td></td>
<td>CHARLOS COVE</td>
<td style="text-align: right;">8500</td>
<td>2020-10-09</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">340</td>
<td>1 Storey</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Low</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">5400</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3944026</td>
<td>MUNI. OF THE DISTRICT OF GUYSBOROUGH</td>
<td style="text-align: right;">5231</td>
<td></td>
<td></td>
<td>HIGHWAY 316</td>
<td></td>
<td>CHARLOS COVE</td>
<td style="text-align: right;">0</td>
<td>2023-02-10</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">340</td>
<td>1 Storey</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Low</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">5400</td>
</tr>
<tr class="even">
<td style="text-align: right;">3944026</td>
<td>MUNI. OF THE DISTRICT OF GUYSBOROUGH</td>
<td style="text-align: right;">5231</td>
<td></td>
<td></td>
<td>HIGHWAY 316</td>
<td></td>
<td>CHARLOS COVE</td>
<td style="text-align: right;">0</td>
<td>2023-06-13</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">340</td>
<td>1 Storey</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Low</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">5400</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3885003</td>
<td>MUNICIPALITY OF THE COUNTY OF INVERNESS</td>
<td style="text-align: right;">1394</td>
<td></td>
<td></td>
<td>MABOU HARBOUR</td>
<td>RD</td>
<td>MABOU HARBOUR</td>
<td style="text-align: right;">0</td>
<td>2020-09-24</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1910</td>
<td style="text-align: right;">1170</td>
<td>1.5 Storey</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">1320304</td>
</tr>
<tr class="even">
<td style="text-align: right;">3885003</td>
<td>MUNICIPALITY OF THE COUNTY OF INVERNESS</td>
<td style="text-align: right;">1394</td>
<td></td>
<td></td>
<td>MABOU HARBOUR</td>
<td>RD</td>
<td>MABOU HARBOUR</td>
<td style="text-align: right;">0</td>
<td>2020-10-08</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1910</td>
<td style="text-align: right;">1170</td>
<td>1.5 Storey</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">1320304</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td style="text-align: right;">10863791</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td style="text-align: right;">320</td>
<td></td>
<td></td>
<td>EVELYN</td>
<td>DR</td>
<td>PARKDALE</td>
<td style="text-align: right;">90000</td>
<td>2021-02-26</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1106</td>
<td>1 Storey</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>true</td>
<td>true</td>
<td style="text-align: right;">118483</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2745755</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">1178</td>
<td></td>
<td></td>
<td>KETCH HARBOUR</td>
<td>RD</td>
<td>KETCH HARBOUR</td>
<td style="text-align: right;">42000</td>
<td>2015-06-30</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">1170</td>
<td>1.5 Storey</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">51687</td>
</tr>
<tr class="even">
<td style="text-align: right;">2745755</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">1178</td>
<td></td>
<td></td>
<td>KETCH HARBOUR</td>
<td>RD</td>
<td>KETCH HARBOUR</td>
<td style="text-align: right;">69000</td>
<td>2011-06-23</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">1170</td>
<td>1.5 Storey</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">51687</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2745755</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">1178</td>
<td></td>
<td></td>
<td>KETCH HARBOUR</td>
<td>RD</td>
<td>KETCH HARBOUR</td>
<td style="text-align: right;">591500</td>
<td>2021-12-22</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">1170</td>
<td>1.5 Storey</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">51687</td>
</tr>
<tr class="even">
<td style="text-align: right;">10751993</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>ARDOISE</td>
<td style="text-align: right;">44900</td>
<td>2022-04-29</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1230</td>
<td>1 Storey</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">48352</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10751993</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>ARDOISE</td>
<td style="text-align: right;">0</td>
<td>2018-10-25</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1230</td>
<td>1 Storey</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">48352</td>
</tr>
<tr class="even">
<td style="text-align: right;">10751993</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>ARDOISE</td>
<td style="text-align: right;">37000</td>
<td>2020-06-04</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1230</td>
<td>1 Storey</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">48352</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10751993</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>ARDOISE</td>
<td style="text-align: right;">51000</td>
<td>2021-07-19</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1230</td>
<td>1 Storey</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">48352</td>
</tr>
<tr class="even">
<td style="text-align: right;">7667817</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">56</td>
<td></td>
<td></td>
<td>LAKE</td>
<td>RD</td>
<td>PLEASANT VALLEY</td>
<td style="text-align: right;">0</td>
<td>2019-11-15</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1996</td>
<td style="text-align: right;">1050</td>
<td>1.5 Storey</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0</td>
<td>false</td>
<td>Low</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">332798</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10986400</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">538</td>
<td></td>
<td></td>
<td>MIDNIGHT</td>
<td>RUN</td>
<td>MIDDLE SACKVILLE</td>
<td style="text-align: right;">767575</td>
<td>2022-05-17</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">2412</td>
<td>Split Entry</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td>false</td>
<td>Good</td>
<td>true</td>
<td>true</td>
<td style="text-align: right;">143400</td>
</tr>
<tr class="even">
<td style="text-align: right;">10986400</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">538</td>
<td></td>
<td></td>
<td>MIDNIGHT</td>
<td>RUN</td>
<td>MIDDLE SACKVILLE</td>
<td style="text-align: right;">0</td>
<td>2022-01-31</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">2412</td>
<td>Split Entry</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td>false</td>
<td>Good</td>
<td>true</td>
<td>true</td>
<td style="text-align: right;">143400</td>
</tr>
</tbody>
</table>
</div>
<p>Great. Now all of the datatypes in our dataset make sense. This was the lowest-hanging fruit in cleaning up this data. Next we’ll move on reshaping the dataset to make it <a href="https://vita.had.co.nz/papers/tidy-data.pdf">tidy</a>.</p>
</section>
<section id="reshaping-data" class="level3">
<h3 class="anchored" data-anchor-id="reshaping-data">Reshaping data</h3>
<p>Next, we’ll look at the <code>:style</code> column. This column is not useful in it’s current state. It contains a mix of information about the type of building and the number of stories, written as a string. This will require idiosyncratic and error-prone parsing by anyone who wants to do any analysis that involves this column. These are the distinct values the column contains:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb25"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> housing-data</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">:style</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">distinct</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb26"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>(<span class="st">"1 Storey"</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a> <span class="st">"2 Storey"</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a> <span class="st">"1.5 Storey"</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a> <span class="va">nil</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a> <span class="st">"Split Level"</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a> <span class="st">"2 Storey Townhouse"</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a> <span class="st">"Manufactured Home"</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a> <span class="st">"2 Storey Duplex"</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a> <span class="st">"Split Entry"</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a> <span class="st">"2 Storey Semi Detached"</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a> <span class="st">"2.5 Storey"</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a> <span class="st">"1.5 Storey Semi Detached"</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a> <span class="st">"1 Storey Duplex"</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a> <span class="st">"1 Storey Townhouse"</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a> <span class="st">"1 Storey Semi Detached"</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a> <span class="st">"3 Storey Triplex"</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a> <span class="st">"Additon"</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a> <span class="st">"1.5 Storey Duplex"</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a> <span class="st">"1.5 Storey Townhouse"</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a> <span class="st">"3 Storey"</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a> <span class="st">"2 Storey Triplex"</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a> <span class="st">"2.5 Storey Semi Detached"</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a> <span class="st">"1.5 Storey Triplex"</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a> <span class="st">"3 Storey Townhouse"</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a> <span class="st">"1 Storey Triplex"</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a> <span class="st">"1 Storey Quadruplex"</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a> <span class="st">"1.5 Storey Quadruplex"</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a> <span class="st">"3 Storey Semi Detached"</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a> <span class="st">"2 Storey Quadruplex"</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a> <span class="st">"2.5 Storey Townhouse"</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a> <span class="st">"3 Storey Duplex"</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a> <span class="st">"3 Storey Quadruplex"</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a> <span class="st">"2.5 Storey Duplex"</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a> <span class="st">"2.5 Storey Triplex"</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a> <span class="st">"2.5 Storey Quadruplex"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first thing to notice here is that two of these values are not like the others. “Manufactured Home” and “Additon” are ambiguous styles. Since we’re not given any information about this column in the <a href="https://www.thedatazone.ca/Assessment/Residential-Dwelling-Characteristics/a859-xvcs/about_data">dataset metadata</a>, we have to make some assumptions about what these values indicate. Maybe the dataset creators didn’t have enough information about these homes to describe them accurately, maybe they considered them somehow fundamentally different from the other house types and in a category of their own, or maybe something else. Either way, we’ll take these out-of-place values to indicate that these rows should be treated differently than the rest of the dataset.</p>
<p>If we were interested in carrying out this different treatment, we could move these rows to a separate dataset, but for our purposes here we can just drop the rows, building on the transformations from the previous step:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb27"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> housing-data</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    (tc/convert-types {<span class="at">:sale-date</span> [<span class="at">:packed-local-date</span> to-date]</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">:under-construction</span> <span class="at">:boolean</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">:finished-basement</span> <span class="at">:boolean</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">:garage</span> <span class="at">:boolean</span>})</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    (tc/drop-rows #(#{<span class="st">"Manufactured Home"</span> <span class="st">"Additon"</span>} (<span class="at">:style</span> <span class="va">%</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>inner-join [351383 22]:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 2%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">:assessment-account-number</th>
<th>:municipal-unit</th>
<th style="text-align: right;">:civic-number</th>
<th>:civic-additional</th>
<th>:civic-direction</th>
<th>:civic-street-name</th>
<th>:civic-suffix</th>
<th>:civic-city-name</th>
<th style="text-align: right;">:sale-price</th>
<th>:sale-date</th>
<th style="text-align: right;">:parcels-in-sale</th>
<th style="text-align: right;">:living-units</th>
<th style="text-align: right;">:year-built</th>
<th style="text-align: right;">:square-foot-living-area</th>
<th>:style</th>
<th style="text-align: right;">:bedrooms</th>
<th style="text-align: right;">:bathrooms</th>
<th>:under-construction</th>
<th>:construction-grade</th>
<th>:finished-basement</th>
<th>:garage</th>
<th style="text-align: right;">:square-feet</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">911593</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">445</td>
<td></td>
<td></td>
<td>WEST PORTERS LAKE</td>
<td>RD</td>
<td>PORTERS LAKE</td>
<td style="text-align: right;">225000</td>
<td>2018-06-28</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1987</td>
<td style="text-align: right;">988</td>
<td>1 Storey</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">107680</td>
</tr>
<tr class="even">
<td style="text-align: right;">911593</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">445</td>
<td></td>
<td></td>
<td>WEST PORTERS LAKE</td>
<td>RD</td>
<td>PORTERS LAKE</td>
<td style="text-align: right;">380000</td>
<td>2022-07-22</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1987</td>
<td style="text-align: right;">988</td>
<td>1 Storey</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">107680</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8502838</td>
<td>MUNICIPALITY OF THE DISTRICT OF ARGYLE</td>
<td style="text-align: right;">1125</td>
<td></td>
<td></td>
<td>DU TITTLE</td>
<td>CH</td>
<td>SURETTES ISLAND</td>
<td style="text-align: right;">0</td>
<td>2023-01-19</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">640</td>
<td>2 Storey</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>false</td>
<td>Low</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">3698858</td>
<td>MUNICIPALITY OF THE COUNTY OF KINGS</td>
<td style="text-align: right;">9739</td>
<td></td>
<td></td>
<td>MAIN</td>
<td>ST</td>
<td>CANNING</td>
<td style="text-align: right;">130000</td>
<td>2022-06-28</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">1632</td>
<td>2 Storey</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td>true</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">7562</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3698858</td>
<td>MUNICIPALITY OF THE COUNTY OF KINGS</td>
<td style="text-align: right;">9739</td>
<td></td>
<td></td>
<td>MAIN</td>
<td>ST</td>
<td>CANNING</td>
<td style="text-align: right;">85000</td>
<td>2019-08-29</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">1632</td>
<td>2 Storey</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td>true</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">7562</td>
</tr>
<tr class="even">
<td style="text-align: right;">3944026</td>
<td>MUNI. OF THE DISTRICT OF GUYSBOROUGH</td>
<td style="text-align: right;">5231</td>
<td></td>
<td></td>
<td>HIGHWAY 316</td>
<td></td>
<td>CHARLOS COVE</td>
<td style="text-align: right;">8500</td>
<td>2020-10-09</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">340</td>
<td>1 Storey</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Low</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">5400</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3944026</td>
<td>MUNI. OF THE DISTRICT OF GUYSBOROUGH</td>
<td style="text-align: right;">5231</td>
<td></td>
<td></td>
<td>HIGHWAY 316</td>
<td></td>
<td>CHARLOS COVE</td>
<td style="text-align: right;">0</td>
<td>2023-02-10</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">340</td>
<td>1 Storey</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Low</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">5400</td>
</tr>
<tr class="even">
<td style="text-align: right;">3944026</td>
<td>MUNI. OF THE DISTRICT OF GUYSBOROUGH</td>
<td style="text-align: right;">5231</td>
<td></td>
<td></td>
<td>HIGHWAY 316</td>
<td></td>
<td>CHARLOS COVE</td>
<td style="text-align: right;">0</td>
<td>2023-06-13</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">340</td>
<td>1 Storey</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Low</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">5400</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3885003</td>
<td>MUNICIPALITY OF THE COUNTY OF INVERNESS</td>
<td style="text-align: right;">1394</td>
<td></td>
<td></td>
<td>MABOU HARBOUR</td>
<td>RD</td>
<td>MABOU HARBOUR</td>
<td style="text-align: right;">0</td>
<td>2020-09-24</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1910</td>
<td style="text-align: right;">1170</td>
<td>1.5 Storey</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">1320304</td>
</tr>
<tr class="even">
<td style="text-align: right;">3885003</td>
<td>MUNICIPALITY OF THE COUNTY OF INVERNESS</td>
<td style="text-align: right;">1394</td>
<td></td>
<td></td>
<td>MABOU HARBOUR</td>
<td>RD</td>
<td>MABOU HARBOUR</td>
<td style="text-align: right;">0</td>
<td>2020-10-08</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1910</td>
<td style="text-align: right;">1170</td>
<td>1.5 Storey</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">1320304</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td style="text-align: right;">10863791</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td style="text-align: right;">320</td>
<td></td>
<td></td>
<td>EVELYN</td>
<td>DR</td>
<td>PARKDALE</td>
<td style="text-align: right;">90000</td>
<td>2021-02-26</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1106</td>
<td>1 Storey</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>true</td>
<td>true</td>
<td style="text-align: right;">118483</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2745755</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">1178</td>
<td></td>
<td></td>
<td>KETCH HARBOUR</td>
<td>RD</td>
<td>KETCH HARBOUR</td>
<td style="text-align: right;">42000</td>
<td>2015-06-30</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">1170</td>
<td>1.5 Storey</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">51687</td>
</tr>
<tr class="even">
<td style="text-align: right;">2745755</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">1178</td>
<td></td>
<td></td>
<td>KETCH HARBOUR</td>
<td>RD</td>
<td>KETCH HARBOUR</td>
<td style="text-align: right;">69000</td>
<td>2011-06-23</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">1170</td>
<td>1.5 Storey</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">51687</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2745755</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">1178</td>
<td></td>
<td></td>
<td>KETCH HARBOUR</td>
<td>RD</td>
<td>KETCH HARBOUR</td>
<td style="text-align: right;">591500</td>
<td>2021-12-22</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">1170</td>
<td>1.5 Storey</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">51687</td>
</tr>
<tr class="even">
<td style="text-align: right;">10751993</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>ARDOISE</td>
<td style="text-align: right;">44900</td>
<td>2022-04-29</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1230</td>
<td>1 Storey</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">48352</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10751993</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>ARDOISE</td>
<td style="text-align: right;">0</td>
<td>2018-10-25</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1230</td>
<td>1 Storey</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">48352</td>
</tr>
<tr class="even">
<td style="text-align: right;">10751993</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>ARDOISE</td>
<td style="text-align: right;">37000</td>
<td>2020-06-04</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1230</td>
<td>1 Storey</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">48352</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10751993</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>ARDOISE</td>
<td style="text-align: right;">51000</td>
<td>2021-07-19</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1230</td>
<td>1 Storey</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">48352</td>
</tr>
<tr class="even">
<td style="text-align: right;">7667817</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">56</td>
<td></td>
<td></td>
<td>LAKE</td>
<td>RD</td>
<td>PLEASANT VALLEY</td>
<td style="text-align: right;">0</td>
<td>2019-11-15</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1996</td>
<td style="text-align: right;">1050</td>
<td>1.5 Storey</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0</td>
<td>false</td>
<td>Low</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">332798</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10986400</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">538</td>
<td></td>
<td></td>
<td>MIDNIGHT</td>
<td>RUN</td>
<td>MIDDLE SACKVILLE</td>
<td style="text-align: right;">767575</td>
<td>2022-05-17</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">2412</td>
<td>Split Entry</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td>false</td>
<td>Good</td>
<td>true</td>
<td>true</td>
<td style="text-align: right;">143400</td>
</tr>
<tr class="even">
<td style="text-align: right;">10986400</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">538</td>
<td></td>
<td></td>
<td>MIDNIGHT</td>
<td>RUN</td>
<td>MIDDLE SACKVILLE</td>
<td style="text-align: right;">0</td>
<td>2022-01-31</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">2412</td>
<td>Split Entry</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td>false</td>
<td>Good</td>
<td>true</td>
<td>true</td>
<td style="text-align: right;">143400</td>
</tr>
</tbody>
</table>
</div>
<p>Removing observations about different types of units from our dataset is one step in the right direction. To move another step closer to a tidy dataset, where each variable is a column and each observation is a row, the next thing we need to do is split up the two pieces of information in this column into two new ones. To do this we can use tablecloth’s reshaping tools, specifically <code>separate-column</code> in this case.</p>
<p>In order to properly handle all the possible values in the column, we’ll write a new helper to parse the number of stories and building type from the list of possible <code>:style</code> strings.</p>
<p>This also introduces a complicated but extremely common problem. We have to start inferring more things about the data. In other words, up to this point we have only been working with the raw data we found from the source. Splitting up this <code>style</code> column into multiple ones means making some assumptions, like what kind of building type do we assign to values that only have a number of stories? Given the context, we can assume it’s a detached home, but at this point we’re encoding some of our own knowledge into the dataset and it’s worth being explicit about it. We’ll also assume that a “Split Level” or “Split Entry” home has 2 stories.</p>
<p>Based on this understanding of the data, we’ll start with a little function to extract the number of stories and building type from any possible value in the <code>:style</code> column:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb28"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> parse-building-type </span>[<span class="kw">val</span>]</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">case</span> <span class="kw">val</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="va">nil</span> <span class="va">nil</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Split Level"</span> [<span class="dv">2</span> <span class="st">"Detached"</span>]</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Split Entry"</span> [<span class="dv">2</span> <span class="st">"Detached"</span>]</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">let</span> [[_ stories building-type] (<span class="kw">re-matches</span> <span class="ss">#"(\d+\.?\d?) Storey\s?(.+)?"</span> <span class="kw">val</span>)]</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>      [(parse-double stories) (<span class="kw">or</span> building-type <span class="st">"Detached"</span>)])))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we can use this helper with tablecloth’s <code>separate-column</code> to generate our two new columns. We’ll also bind this intermediate dataset to a new symbol to facilitate working with it in future steps:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb29"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> partially-cleaned-housing-data</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">-&gt;</span> housing-data</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>      (tc/convert-types {<span class="at">:sale-date</span> [<span class="at">:packed-local-date</span> to-date]</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">:under-construction</span> <span class="at">:boolean</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">:finished-basement</span> <span class="at">:boolean</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">:garage</span> <span class="at">:boolean</span>})</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>      (tc/drop-rows #(#{<span class="st">"Manufactured Home"</span> <span class="st">"Additon"</span>} (<span class="at">:style</span> <span class="va">%</span>)))</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>      (tc/separate-column <span class="at">:style</span> [<span class="at">:stories</span> <span class="at">:building-type</span>] parse-building-type)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-integrity" class="level2">
<h2 class="anchored" data-anchor-id="data-integrity">Data Integrity</h2>
<p>Now that we’ve fixed up the structural or technical issues with the data, there is a whole class of new problems to deal with that have much less obvious solutions. For these next types of issues, we’ll need to actually look at the data and make some judgment calls about how to handle apparent errors.</p>
<section id="handling-missing-values" class="level3">
<h3 class="anchored" data-anchor-id="handling-missing-values">Handling missing values</h3>
<p>Most</p>
<p>Get columns with missing values</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb30"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> partially-cleaned-housing-data</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    tc/info</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows (<span class="kw">comp</span> <span class="kw">pos?</span> <span class="at">:n-missing</span>))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">:col-name</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb31"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&lt;keyword&gt;[<span class="dv">15</span>]</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="at">:col-name</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>[<span class="at">:civic-number</span>, <span class="at">:civic-additional</span>, <span class="at">:civic-direction</span>, <span class="at">:civic-street-name</span>, <span class="at">:civic-suffix</span>, <span class="at">:civic-city-name</span>, <span class="at">:sale-price</span>, <span class="at">:parcels-in-sale</span>, <span class="at">:year-built</span>, <span class="at">:square-foot-living-area</span>, <span class="at">:stories</span>, <span class="at">:building-type</span>, <span class="at">:bedrooms</span>, <span class="at">:construction-grade</span>, <span class="at">:square-feet</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Drop any numeric column with value of 0:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb32"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> no-missing-values</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">let</span> [cols-missing-values [<span class="at">:sale-price</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">:parcels-in-sale</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">:year-built</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">:square-foot-living-area</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">:stories</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">:building-type</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">:bedrooms</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">:construction-grade</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">:square-feet</span>]</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>        numeric-cols (<span class="kw">-&gt;</span> partially-cleaned-housing-data</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>                         (tc/select-columns <span class="at">:type/numerical</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>                         tc/column-names)]</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">-&gt;</span> partially-cleaned-housing-data</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>        (tc/drop-rows #(<span class="kw">some</span> (<span class="kw">fn</span> [col-name]</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>                               (<span class="kw">nil?</span> (col-name <span class="va">%</span>)))</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>                             cols-missing-values))</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>        (tc/drop-rows #(<span class="kw">some</span> (<span class="kw">fn</span> [col-name]</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>                               (<span class="kw">zero?</span> (col-name <span class="va">%</span> <span class="dv">0</span>)))</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>                             numeric-cols)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Drop missing sale price, also drop 0 sale price, these don’t provide the information we’re looking for</p>
</section>
</section>
<section id="check-for-duplicate-values" class="level2">
<h2 class="anchored" data-anchor-id="check-for-duplicate-values">Check for duplicate values</h2>
<section id="removing-fully-duplicate-rows" class="level3">
<h3 class="anchored" data-anchor-id="removing-fully-duplicate-rows">Removing fully duplicate rows</h3>
<p>The first thing we can do is check for entirely duplicate rows. The easiest way to do this is to use <code>scicloj.tcutils.api/duplicate-rows</code></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb33"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>(tcu/duplicate-rows no-missing-values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>inner-join [0 23]:</p>
<table class="caption-top" style="width:100%;">
<colgroup>
<col style="width: 7%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 2%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">:assessment-account-number</th>
<th>:municipal-unit</th>
<th style="text-align: right;">:civic-number</th>
<th>:civic-additional</th>
<th>:civic-direction</th>
<th>:civic-street-name</th>
<th>:civic-suffix</th>
<th>:civic-city-name</th>
<th style="text-align: right;">:sale-price</th>
<th>:sale-date</th>
<th style="text-align: right;">:parcels-in-sale</th>
<th style="text-align: right;">:living-units</th>
<th style="text-align: right;">:year-built</th>
<th style="text-align: right;">:square-foot-living-area</th>
<th style="text-align: right;">:stories</th>
<th>:building-type</th>
<th style="text-align: right;">:bedrooms</th>
<th style="text-align: right;">:bathrooms</th>
<th>:under-construction</th>
<th>:construction-grade</th>
<th>:finished-basement</th>
<th>:garage</th>
<th style="text-align: right;">:square-feet</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
<p>In this case it turns out there are none, which is good. But it’s still possible we don’t want to include every row in the final dataset.</p>
</section>
<section id="selecting-relevant-rows" class="level3">
<h3 class="anchored" data-anchor-id="selecting-relevant-rows">Selecting relevant rows</h3>
<p>One key feature of tidy datasets, as mentioned above, is that they contain values collected about only a single type of observational unit. We’re interested in building a model to predict the price of single family homes in Nova Scotia, so we’ll want a dataset that contains only data about those types of homes. One clue that a dataset contains values about multiple types of things is values that get repeated in many rows.</p>
<p>We can inspect our dataset to see how many rows appear to be duplicates by grouping by the assessment account number and sale date. There should only be one sale per property per day, so we will want to select any rows that have more than one and investigate these rows:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb34"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> potentially-duplicate-row-counts</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">-&gt;</span> no-missing-values</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>      (tc/group-by [<span class="at">:assessment-account-number</span> <span class="at">:sale-date</span>])</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>      (tc/aggregate {<span class="at">:count</span> tc/row-count})</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>      (tc/select-rows #(<span class="kw">&lt;</span> <span class="dv">1</span> (<span class="at">:count</span> <span class="va">%</span>)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(-&gt; partially-cleaned-housing-data (tc/map-columns :sale-year :sale-date (memfn getYear)) (ploclo/layer-histogram {:=x :sale-year}))</p>
<p>TODO Explain</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb35"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">let</span> [potentially-duplicate-row-ids (<span class="kw">-&gt;</span> potentially-duplicate-row-counts</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                                        (tc/join-columns <span class="at">:id</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                                                         [<span class="at">:assessment-account-number</span> <span class="at">:sale-date</span>]</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                                                         {<span class="at">:result-type</span> <span class="at">:seq</span>}))]</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">-&gt;</span> no-missing-values</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>      (tc/map-columns <span class="at">:id</span> [<span class="at">:assessment-account-number</span> <span class="at">:sale-date</span>] <span class="kw">vector</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>      (tc/inner-join potentially-duplicate-row-ids <span class="at">:id</span>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>      (tc/drop-columns <span class="at">:id</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>      (tc/order-by [<span class="at">:assessment-account-number</span> <span class="at">:sale-date</span>])))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>inner-join [2184 24]:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 1%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">:assessment-account-number</th>
<th>:municipal-unit</th>
<th style="text-align: right;">:civic-number</th>
<th>:civic-additional</th>
<th>:civic-direction</th>
<th>:civic-street-name</th>
<th>:civic-suffix</th>
<th>:civic-city-name</th>
<th style="text-align: right;">:sale-price</th>
<th>:sale-date</th>
<th style="text-align: right;">:parcels-in-sale</th>
<th style="text-align: right;">:living-units</th>
<th style="text-align: right;">:year-built</th>
<th style="text-align: right;">:square-foot-living-area</th>
<th style="text-align: right;">:stories</th>
<th>:building-type</th>
<th style="text-align: right;">:bedrooms</th>
<th style="text-align: right;">:bathrooms</th>
<th>:under-construction</th>
<th>:construction-grade</th>
<th>:finished-basement</th>
<th>:garage</th>
<th style="text-align: right;">:square-feet</th>
<th style="text-align: right;">:count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">9075</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td style="text-align: right;">491</td>
<td></td>
<td></td>
<td>OAKLAND</td>
<td>RD</td>
<td>INDIAN POINT</td>
<td style="text-align: right;">155000</td>
<td>2014-08-06</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">668</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">67954</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">9075</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td style="text-align: right;">491</td>
<td></td>
<td></td>
<td>OAKLAND</td>
<td>RD</td>
<td>INDIAN POINT</td>
<td style="text-align: right;">155000</td>
<td>2014-08-06</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1977</td>
<td style="text-align: right;">1390</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">67954</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9075</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td style="text-align: right;">491</td>
<td></td>
<td></td>
<td>OAKLAND</td>
<td>RD</td>
<td>INDIAN POINT</td>
<td style="text-align: right;">170000</td>
<td>2018-11-02</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">668</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">67954</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">9075</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td style="text-align: right;">491</td>
<td></td>
<td></td>
<td>OAKLAND</td>
<td>RD</td>
<td>INDIAN POINT</td>
<td style="text-align: right;">170000</td>
<td>2018-11-02</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1977</td>
<td style="text-align: right;">1390</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">67954</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">18341</td>
<td>TOWN OF KENTVILLE</td>
<td style="text-align: right;">242</td>
<td></td>
<td></td>
<td>MAIN</td>
<td>ST</td>
<td>KENTVILLE</td>
<td style="text-align: right;">93000</td>
<td>2016-08-01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1888</td>
<td style="text-align: right;">972</td>
<td style="text-align: right;">1.5</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">4413</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">18341</td>
<td>TOWN OF KENTVILLE</td>
<td style="text-align: right;">242</td>
<td></td>
<td></td>
<td>MAIN</td>
<td>ST</td>
<td>KENTVILLE</td>
<td style="text-align: right;">1000</td>
<td>2016-08-01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1888</td>
<td style="text-align: right;">972</td>
<td style="text-align: right;">1.5</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">4413</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">43397</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">775</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>MOUNT UNIACKE</td>
<td style="text-align: right;">123000</td>
<td>2015-10-29</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1008</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td>true</td>
<td>Average</td>
<td>true</td>
<td>true</td>
<td style="text-align: right;">15893</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">43397</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">775</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>MOUNT UNIACKE</td>
<td style="text-align: right;">123000</td>
<td>2015-10-29</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1903</td>
<td style="text-align: right;">864</td>
<td style="text-align: right;">1.5</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">15893</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">44296</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">6555</td>
<td></td>
<td></td>
<td>CHESTER</td>
<td>AVE</td>
<td>HALIFAX</td>
<td style="text-align: right;">1200</td>
<td>2017-01-07</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1943</td>
<td style="text-align: right;">1710</td>
<td style="text-align: right;">2.0</td>
<td>Detached</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">4343</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">44296</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">6555</td>
<td></td>
<td></td>
<td>CHESTER</td>
<td>AVE</td>
<td>HALIFAX</td>
<td style="text-align: right;">315000</td>
<td>2017-01-07</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1943</td>
<td style="text-align: right;">1710</td>
<td style="text-align: right;">2.0</td>
<td>Detached</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">4343</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td style="text-align: right;">10939399</td>
<td>TOWN OF BERWICK</td>
<td style="text-align: right;">12</td>
<td></td>
<td></td>
<td>GALA</td>
<td>DR</td>
<td>BERWICK</td>
<td style="text-align: right;">70000</td>
<td>2022-01-10</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1462</td>
<td style="text-align: right;">1.0</td>
<td>Semi Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">6738</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10939429</td>
<td>TOWN OF BERWICK</td>
<td style="text-align: right;">13</td>
<td></td>
<td></td>
<td>GALA</td>
<td>DR</td>
<td>BERWICK</td>
<td style="text-align: right;">70000</td>
<td>2022-06-30</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1462</td>
<td style="text-align: right;">1.0</td>
<td>Semi Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">7693</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">10939429</td>
<td>TOWN OF BERWICK</td>
<td style="text-align: right;">13</td>
<td></td>
<td></td>
<td>GALA</td>
<td>DR</td>
<td>BERWICK</td>
<td style="text-align: right;">337283</td>
<td>2022-06-30</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1462</td>
<td style="text-align: right;">1.0</td>
<td>Semi Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">7693</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10944831</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">426</td>
<td></td>
<td></td>
<td>ESS</td>
<td>RD</td>
<td>UPPER NINE MILE RIVER</td>
<td style="text-align: right;">20000</td>
<td>2021-12-06</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">1264</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">437725</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">10944831</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">426</td>
<td></td>
<td></td>
<td>ESS</td>
<td>RD</td>
<td>UPPER NINE MILE RIVER</td>
<td style="text-align: right;">20000</td>
<td>2021-12-06</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1344</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">437725</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10969220</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">36</td>
<td></td>
<td></td>
<td>ELIZABETH</td>
<td>AVE</td>
<td>GARLANDS CROSSING</td>
<td style="text-align: right;">330955</td>
<td>2022-02-24</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1302</td>
<td style="text-align: right;">1.0</td>
<td>Semi Detached</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">5016</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">10969220</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">36</td>
<td></td>
<td></td>
<td>ELIZABETH</td>
<td>AVE</td>
<td>GARLANDS CROSSING</td>
<td style="text-align: right;">240000</td>
<td>2022-02-24</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1302</td>
<td style="text-align: right;">1.0</td>
<td>Semi Detached</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">5016</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10991625</td>
<td>MUNICIPALITY OF THE COUNTY OF INVERNESS</td>
<td style="text-align: right;">2581</td>
<td></td>
<td></td>
<td>SHORE</td>
<td>RD</td>
<td>MARGAREE HARBOUR</td>
<td style="text-align: right;">600000</td>
<td>2022-06-03</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1970</td>
<td style="text-align: right;">2380</td>
<td style="text-align: right;">1.5</td>
<td>Detached</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td>false</td>
<td>Average</td>
<td>true</td>
<td>false</td>
<td style="text-align: right;">125986</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">10991625</td>
<td>MUNICIPALITY OF THE COUNTY OF INVERNESS</td>
<td style="text-align: right;">2581</td>
<td></td>
<td></td>
<td>SHORE</td>
<td>RD</td>
<td>MARGAREE HARBOUR</td>
<td style="text-align: right;">600000</td>
<td>2022-06-03</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1985</td>
<td style="text-align: right;">552</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">125986</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11021141</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">57</td>
<td></td>
<td></td>
<td>BRIANNA</td>
<td>DR</td>
<td>LANTZ</td>
<td style="text-align: right;">600000</td>
<td>2023-04-28</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">2005</td>
<td style="text-align: right;">2.0</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td>true</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">11320</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">11021141</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">57</td>
<td></td>
<td></td>
<td>BRIANNA</td>
<td>DR</td>
<td>LANTZ</td>
<td style="text-align: right;">600000</td>
<td>2023-04-28</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">2029</td>
<td style="text-align: right;">2.0</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td>true</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">11320</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
<p>Remove rows with more than one living unit, these aren’t in the category of thing that we want to model:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb36"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">let</span> [potentially-duplicate-row-ids (<span class="kw">-&gt;</span> potentially-duplicate-row-counts</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                                        (tc/join-columns <span class="at">:id</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                                                         [<span class="at">:assessment-account-number</span> <span class="at">:sale-date</span>]</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>                                                         {<span class="at">:result-type</span> <span class="at">:seq</span>}))]</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">-&gt;</span> no-missing-values</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>      (tc/map-columns <span class="at">:id</span> [<span class="at">:assessment-account-number</span> <span class="at">:sale-date</span>] <span class="kw">vector</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>      (tc/inner-join potentially-duplicate-row-ids <span class="at">:id</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>      (tc/drop-columns <span class="at">:id</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>      (tc/order-by [<span class="at">:assessment-account-number</span> <span class="at">:sale-date</span>])</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>      (tc/drop-rows #(<span class="kw">&gt;</span> (<span class="at">:living-units</span> <span class="va">%</span>) <span class="dv">1</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>inner-join [686 24]:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 1%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">:assessment-account-number</th>
<th>:municipal-unit</th>
<th style="text-align: right;">:civic-number</th>
<th>:civic-additional</th>
<th>:civic-direction</th>
<th>:civic-street-name</th>
<th>:civic-suffix</th>
<th>:civic-city-name</th>
<th style="text-align: right;">:sale-price</th>
<th>:sale-date</th>
<th style="text-align: right;">:parcels-in-sale</th>
<th style="text-align: right;">:living-units</th>
<th style="text-align: right;">:year-built</th>
<th style="text-align: right;">:square-foot-living-area</th>
<th style="text-align: right;">:stories</th>
<th>:building-type</th>
<th style="text-align: right;">:bedrooms</th>
<th style="text-align: right;">:bathrooms</th>
<th>:under-construction</th>
<th>:construction-grade</th>
<th>:finished-basement</th>
<th>:garage</th>
<th style="text-align: right;">:square-feet</th>
<th style="text-align: right;">:count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">18341</td>
<td>TOWN OF KENTVILLE</td>
<td style="text-align: right;">242</td>
<td></td>
<td></td>
<td>MAIN</td>
<td>ST</td>
<td>KENTVILLE</td>
<td style="text-align: right;">93000</td>
<td>2016-08-01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1888</td>
<td style="text-align: right;">972</td>
<td style="text-align: right;">1.5</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">4413</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">18341</td>
<td>TOWN OF KENTVILLE</td>
<td style="text-align: right;">242</td>
<td></td>
<td></td>
<td>MAIN</td>
<td>ST</td>
<td>KENTVILLE</td>
<td style="text-align: right;">1000</td>
<td>2016-08-01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1888</td>
<td style="text-align: right;">972</td>
<td style="text-align: right;">1.5</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">4413</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">43397</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">775</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>MOUNT UNIACKE</td>
<td style="text-align: right;">123000</td>
<td>2015-10-29</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1008</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td>true</td>
<td>Average</td>
<td>true</td>
<td>true</td>
<td style="text-align: right;">15893</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">43397</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">775</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>MOUNT UNIACKE</td>
<td style="text-align: right;">123000</td>
<td>2015-10-29</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1903</td>
<td style="text-align: right;">864</td>
<td style="text-align: right;">1.5</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">15893</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">47244</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td style="text-align: right;">28</td>
<td></td>
<td></td>
<td>CONRADIN</td>
<td>DR</td>
<td>CONQUERALL BANK</td>
<td style="text-align: right;">459000</td>
<td>2014-01-06</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1957</td>
<td style="text-align: right;">792</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td>false</td>
<td>Low</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">105851</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">47244</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td style="text-align: right;">28</td>
<td></td>
<td></td>
<td>CONRADIN</td>
<td>DR</td>
<td>CONQUERALL BANK</td>
<td style="text-align: right;">459000</td>
<td>2014-01-06</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1957</td>
<td style="text-align: right;">2558</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">105851</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">47244</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td style="text-align: right;">28</td>
<td></td>
<td></td>
<td>CONRADIN</td>
<td>DR</td>
<td>CONQUERALL BANK</td>
<td style="text-align: right;">600000</td>
<td>2017-04-03</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1957</td>
<td style="text-align: right;">792</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td>false</td>
<td>Low</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">105851</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">47244</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td style="text-align: right;">28</td>
<td></td>
<td></td>
<td>CONRADIN</td>
<td>DR</td>
<td>CONQUERALL BANK</td>
<td style="text-align: right;">600000</td>
<td>2017-04-03</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1957</td>
<td style="text-align: right;">2558</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">105851</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">50997</td>
<td>MUNICIPALITY OF THE COUNTY OF CUMBERLAND</td>
<td style="text-align: right;">10271</td>
<td></td>
<td></td>
<td>DURHAM</td>
<td>ST</td>
<td>PUGWASH</td>
<td style="text-align: right;">14000</td>
<td>2019-02-01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">448</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Fair</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">6400</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">50997</td>
<td>MUNICIPALITY OF THE COUNTY OF CUMBERLAND</td>
<td style="text-align: right;">10271</td>
<td></td>
<td></td>
<td>DURHAM</td>
<td>ST</td>
<td>PUGWASH</td>
<td style="text-align: right;">14000</td>
<td>2019-02-01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">704</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Fair</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">6400</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td style="text-align: right;">10904447</td>
<td>MUNICIPALITY OF THE COUNTY OF ANTIGONISH</td>
<td style="text-align: right;">51</td>
<td></td>
<td></td>
<td>ANCHOR</td>
<td>LANE</td>
<td>HARBOUR CENTRE</td>
<td style="text-align: right;">215000</td>
<td>2020-10-20</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">3088</td>
<td style="text-align: right;">2.0</td>
<td>Detached</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Good</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">383328</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10905206</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">166</td>
<td></td>
<td></td>
<td>TALUS</td>
<td>AVE</td>
<td>BEDFORD</td>
<td style="text-align: right;">1015000</td>
<td>2021-12-21</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">4528</td>
<td style="text-align: right;">2.0</td>
<td>Detached</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td>false</td>
<td>Good</td>
<td>true</td>
<td>false</td>
<td style="text-align: right;">6458</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">10905206</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">166</td>
<td></td>
<td></td>
<td>TALUS</td>
<td>AVE</td>
<td>BEDFORD</td>
<td style="text-align: right;">930355</td>
<td>2021-12-21</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">4528</td>
<td style="text-align: right;">2.0</td>
<td>Detached</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td>false</td>
<td>Good</td>
<td>true</td>
<td>false</td>
<td style="text-align: right;">6458</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10905311</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">199</td>
<td></td>
<td></td>
<td>TALUS</td>
<td>AVE</td>
<td>BEDFORD</td>
<td style="text-align: right;">699943</td>
<td>2021-12-22</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">3012</td>
<td style="text-align: right;">2.0</td>
<td>Detached</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td>false</td>
<td>Good</td>
<td>true</td>
<td>true</td>
<td style="text-align: right;">6364</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">10905311</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">199</td>
<td></td>
<td></td>
<td>TALUS</td>
<td>AVE</td>
<td>BEDFORD</td>
<td style="text-align: right;">880000</td>
<td>2021-12-22</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">3012</td>
<td style="text-align: right;">2.0</td>
<td>Detached</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td>false</td>
<td>Good</td>
<td>true</td>
<td>true</td>
<td style="text-align: right;">6364</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10939399</td>
<td>TOWN OF BERWICK</td>
<td style="text-align: right;">12</td>
<td></td>
<td></td>
<td>GALA</td>
<td>DR</td>
<td>BERWICK</td>
<td style="text-align: right;">361828</td>
<td>2022-01-10</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1462</td>
<td style="text-align: right;">1.0</td>
<td>Semi Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">6738</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">10939399</td>
<td>TOWN OF BERWICK</td>
<td style="text-align: right;">12</td>
<td></td>
<td></td>
<td>GALA</td>
<td>DR</td>
<td>BERWICK</td>
<td style="text-align: right;">70000</td>
<td>2022-01-10</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1462</td>
<td style="text-align: right;">1.0</td>
<td>Semi Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">6738</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10939429</td>
<td>TOWN OF BERWICK</td>
<td style="text-align: right;">13</td>
<td></td>
<td></td>
<td>GALA</td>
<td>DR</td>
<td>BERWICK</td>
<td style="text-align: right;">70000</td>
<td>2022-06-30</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1462</td>
<td style="text-align: right;">1.0</td>
<td>Semi Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">7693</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">10939429</td>
<td>TOWN OF BERWICK</td>
<td style="text-align: right;">13</td>
<td></td>
<td></td>
<td>GALA</td>
<td>DR</td>
<td>BERWICK</td>
<td style="text-align: right;">337283</td>
<td>2022-06-30</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1462</td>
<td style="text-align: right;">1.0</td>
<td>Semi Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">7693</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10969220</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">36</td>
<td></td>
<td></td>
<td>ELIZABETH</td>
<td>AVE</td>
<td>GARLANDS CROSSING</td>
<td style="text-align: right;">330955</td>
<td>2022-02-24</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1302</td>
<td style="text-align: right;">1.0</td>
<td>Semi Detached</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">5016</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">10969220</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">36</td>
<td></td>
<td></td>
<td>ELIZABETH</td>
<td>AVE</td>
<td>GARLANDS CROSSING</td>
<td style="text-align: right;">240000</td>
<td>2022-02-24</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1302</td>
<td style="text-align: right;">1.0</td>
<td>Semi Detached</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">5016</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
<p>Leaves us with 686 rows to explain</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb37"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">let</span> [potentially-duplicate-row-ids (<span class="kw">-&gt;</span> potentially-duplicate-row-counts</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>                                        (tc/join-columns <span class="at">:id</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                                                         [<span class="at">:assessment-account-number</span> <span class="at">:sale-date</span>]</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                                                         {<span class="at">:result-type</span> <span class="at">:seq</span>}))]</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">-&gt;</span> no-missing-values</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>      (tc/map-columns <span class="at">:id</span> [<span class="at">:assessment-account-number</span> <span class="at">:sale-date</span>] <span class="kw">vector</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>      (tc/inner-join potentially-duplicate-row-ids <span class="at">:id</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>      (tc/drop-columns <span class="at">:id</span>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>      (tc/order-by [<span class="at">:assessment-account-number</span> <span class="at">:sale-date</span>])</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>      (tc/drop-rows #(<span class="kw">&gt;</span> (<span class="at">:living-units</span> <span class="va">%</span>) <span class="dv">1</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>inner-join [686 24]:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 1%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">:assessment-account-number</th>
<th>:municipal-unit</th>
<th style="text-align: right;">:civic-number</th>
<th>:civic-additional</th>
<th>:civic-direction</th>
<th>:civic-street-name</th>
<th>:civic-suffix</th>
<th>:civic-city-name</th>
<th style="text-align: right;">:sale-price</th>
<th>:sale-date</th>
<th style="text-align: right;">:parcels-in-sale</th>
<th style="text-align: right;">:living-units</th>
<th style="text-align: right;">:year-built</th>
<th style="text-align: right;">:square-foot-living-area</th>
<th style="text-align: right;">:stories</th>
<th>:building-type</th>
<th style="text-align: right;">:bedrooms</th>
<th style="text-align: right;">:bathrooms</th>
<th>:under-construction</th>
<th>:construction-grade</th>
<th>:finished-basement</th>
<th>:garage</th>
<th style="text-align: right;">:square-feet</th>
<th style="text-align: right;">:count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">18341</td>
<td>TOWN OF KENTVILLE</td>
<td style="text-align: right;">242</td>
<td></td>
<td></td>
<td>MAIN</td>
<td>ST</td>
<td>KENTVILLE</td>
<td style="text-align: right;">93000</td>
<td>2016-08-01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1888</td>
<td style="text-align: right;">972</td>
<td style="text-align: right;">1.5</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">4413</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">18341</td>
<td>TOWN OF KENTVILLE</td>
<td style="text-align: right;">242</td>
<td></td>
<td></td>
<td>MAIN</td>
<td>ST</td>
<td>KENTVILLE</td>
<td style="text-align: right;">1000</td>
<td>2016-08-01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1888</td>
<td style="text-align: right;">972</td>
<td style="text-align: right;">1.5</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">4413</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">43397</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">775</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>MOUNT UNIACKE</td>
<td style="text-align: right;">123000</td>
<td>2015-10-29</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1008</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td>true</td>
<td>Average</td>
<td>true</td>
<td>true</td>
<td style="text-align: right;">15893</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">43397</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">775</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>MOUNT UNIACKE</td>
<td style="text-align: right;">123000</td>
<td>2015-10-29</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1903</td>
<td style="text-align: right;">864</td>
<td style="text-align: right;">1.5</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">15893</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">47244</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td style="text-align: right;">28</td>
<td></td>
<td></td>
<td>CONRADIN</td>
<td>DR</td>
<td>CONQUERALL BANK</td>
<td style="text-align: right;">459000</td>
<td>2014-01-06</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1957</td>
<td style="text-align: right;">792</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td>false</td>
<td>Low</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">105851</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">47244</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td style="text-align: right;">28</td>
<td></td>
<td></td>
<td>CONRADIN</td>
<td>DR</td>
<td>CONQUERALL BANK</td>
<td style="text-align: right;">459000</td>
<td>2014-01-06</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1957</td>
<td style="text-align: right;">2558</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">105851</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">47244</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td style="text-align: right;">28</td>
<td></td>
<td></td>
<td>CONRADIN</td>
<td>DR</td>
<td>CONQUERALL BANK</td>
<td style="text-align: right;">600000</td>
<td>2017-04-03</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1957</td>
<td style="text-align: right;">792</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td>false</td>
<td>Low</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">105851</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">47244</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td style="text-align: right;">28</td>
<td></td>
<td></td>
<td>CONRADIN</td>
<td>DR</td>
<td>CONQUERALL BANK</td>
<td style="text-align: right;">600000</td>
<td>2017-04-03</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1957</td>
<td style="text-align: right;">2558</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">105851</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">50997</td>
<td>MUNICIPALITY OF THE COUNTY OF CUMBERLAND</td>
<td style="text-align: right;">10271</td>
<td></td>
<td></td>
<td>DURHAM</td>
<td>ST</td>
<td>PUGWASH</td>
<td style="text-align: right;">14000</td>
<td>2019-02-01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">448</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Fair</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">6400</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">50997</td>
<td>MUNICIPALITY OF THE COUNTY OF CUMBERLAND</td>
<td style="text-align: right;">10271</td>
<td></td>
<td></td>
<td>DURHAM</td>
<td>ST</td>
<td>PUGWASH</td>
<td style="text-align: right;">14000</td>
<td>2019-02-01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">704</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Fair</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">6400</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td style="text-align: right;">10904447</td>
<td>MUNICIPALITY OF THE COUNTY OF ANTIGONISH</td>
<td style="text-align: right;">51</td>
<td></td>
<td></td>
<td>ANCHOR</td>
<td>LANE</td>
<td>HARBOUR CENTRE</td>
<td style="text-align: right;">215000</td>
<td>2020-10-20</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">3088</td>
<td style="text-align: right;">2.0</td>
<td>Detached</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Good</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">383328</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10905206</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">166</td>
<td></td>
<td></td>
<td>TALUS</td>
<td>AVE</td>
<td>BEDFORD</td>
<td style="text-align: right;">1015000</td>
<td>2021-12-21</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">4528</td>
<td style="text-align: right;">2.0</td>
<td>Detached</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td>false</td>
<td>Good</td>
<td>true</td>
<td>false</td>
<td style="text-align: right;">6458</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">10905206</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">166</td>
<td></td>
<td></td>
<td>TALUS</td>
<td>AVE</td>
<td>BEDFORD</td>
<td style="text-align: right;">930355</td>
<td>2021-12-21</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">4528</td>
<td style="text-align: right;">2.0</td>
<td>Detached</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td>false</td>
<td>Good</td>
<td>true</td>
<td>false</td>
<td style="text-align: right;">6458</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10905311</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">199</td>
<td></td>
<td></td>
<td>TALUS</td>
<td>AVE</td>
<td>BEDFORD</td>
<td style="text-align: right;">699943</td>
<td>2021-12-22</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">3012</td>
<td style="text-align: right;">2.0</td>
<td>Detached</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td>false</td>
<td>Good</td>
<td>true</td>
<td>true</td>
<td style="text-align: right;">6364</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">10905311</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">199</td>
<td></td>
<td></td>
<td>TALUS</td>
<td>AVE</td>
<td>BEDFORD</td>
<td style="text-align: right;">880000</td>
<td>2021-12-22</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">3012</td>
<td style="text-align: right;">2.0</td>
<td>Detached</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td>false</td>
<td>Good</td>
<td>true</td>
<td>true</td>
<td style="text-align: right;">6364</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10939399</td>
<td>TOWN OF BERWICK</td>
<td style="text-align: right;">12</td>
<td></td>
<td></td>
<td>GALA</td>
<td>DR</td>
<td>BERWICK</td>
<td style="text-align: right;">361828</td>
<td>2022-01-10</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1462</td>
<td style="text-align: right;">1.0</td>
<td>Semi Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">6738</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">10939399</td>
<td>TOWN OF BERWICK</td>
<td style="text-align: right;">12</td>
<td></td>
<td></td>
<td>GALA</td>
<td>DR</td>
<td>BERWICK</td>
<td style="text-align: right;">70000</td>
<td>2022-01-10</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1462</td>
<td style="text-align: right;">1.0</td>
<td>Semi Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">6738</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10939429</td>
<td>TOWN OF BERWICK</td>
<td style="text-align: right;">13</td>
<td></td>
<td></td>
<td>GALA</td>
<td>DR</td>
<td>BERWICK</td>
<td style="text-align: right;">70000</td>
<td>2022-06-30</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1462</td>
<td style="text-align: right;">1.0</td>
<td>Semi Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">7693</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">10939429</td>
<td>TOWN OF BERWICK</td>
<td style="text-align: right;">13</td>
<td></td>
<td></td>
<td>GALA</td>
<td>DR</td>
<td>BERWICK</td>
<td style="text-align: right;">337283</td>
<td>2022-06-30</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1462</td>
<td style="text-align: right;">1.0</td>
<td>Semi Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">7693</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10969220</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">36</td>
<td></td>
<td></td>
<td>ELIZABETH</td>
<td>AVE</td>
<td>GARLANDS CROSSING</td>
<td style="text-align: right;">330955</td>
<td>2022-02-24</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1302</td>
<td style="text-align: right;">1.0</td>
<td>Semi Detached</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">5016</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">10969220</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">36</td>
<td></td>
<td></td>
<td>ELIZABETH</td>
<td>AVE</td>
<td>GARLANDS CROSSING</td>
<td style="text-align: right;">240000</td>
<td>2022-02-24</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1302</td>
<td style="text-align: right;">1.0</td>
<td>Semi Detached</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">5016</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
<p>Many reasons why these remaining rows are wrong, deal with them case-by-case</p>
<p>Multiple sale prices and multiple number of parcels</p>
<p>TODO: Finish this – revisit sanity of explaining every possible error in the data. How much cleaning is necessary to do a meaningful analysis? TO DROP:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb38"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">let</span> [potentially-duplicate-row-ids (<span class="kw">-&gt;</span> potentially-duplicate-row-counts</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                                        (tc/join-columns <span class="at">:id</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                                                         [<span class="at">:assessment-account-number</span> <span class="at">:sale-date</span>]</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                                                         {<span class="at">:result-type</span> <span class="at">:seq</span>}))]</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">-&gt;</span> no-missing-values</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>      (tc/map-columns <span class="at">:id</span> [<span class="at">:assessment-account-number</span> <span class="at">:sale-date</span>] <span class="kw">vector</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>      (tc/inner-join potentially-duplicate-row-ids <span class="at">:id</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>      (tc/drop-columns <span class="at">:id</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>      (tc/order-by [<span class="at">:assessment-account-number</span> <span class="at">:sale-date</span>])</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>      (tc/drop-rows #(<span class="kw">&gt;</span> (<span class="at">:living-units</span> <span class="va">%</span>) <span class="dv">1</span>))</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>      (tc/select-columns [<span class="at">:assessment-account-number</span> <span class="at">:sale-date</span> <span class="at">:sale-price</span> <span class="at">:parcels-in-sale</span>])</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>      (tc/fold-by [<span class="at">:assessment-account-number</span> <span class="at">:sale-date</span>])</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>      (tc/select-rows #(<span class="kw">and</span> (<span class="kw">not</span> (<span class="kw">apply</span> <span class="kw">=</span> (<span class="at">:sale-price</span> <span class="va">%</span>)))</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>                            (<span class="kw">not</span> (<span class="kw">apply</span> <span class="kw">=</span> (<span class="at">:parcels-in-sale</span> <span class="va">%</span>)))))</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>      (tc/unroll [<span class="at">:sale-price</span> <span class="at">:parcels-in-sale</span>])</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">:assessment-account-number</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb39"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&lt;int64&gt;[<span class="dv">14</span>]</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="at">:assessment-account-number</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">931772</span>, <span class="dv">931772</span>, <span class="dv">2216272</span>, <span class="dv">2216272</span>, <span class="dv">4009185</span>, <span class="dv">4009185</span>, <span class="dv">10286433</span>, <span class="dv">10286433</span>, <span class="dv">10939399</span>, <span class="dv">10939399</span>, <span class="dv">10939429</span>, <span class="dv">10939429</span>, <span class="dv">10969220</span>, <span class="dv">10969220</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb40"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">let</span> [potentially-duplicate-row-ids (<span class="kw">-&gt;</span> potentially-duplicate-row-counts</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>                                        (tc/join-columns <span class="at">:id</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                                                         [<span class="at">:assessment-account-number</span> <span class="at">:sale-date</span>]</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                                                         {<span class="at">:result-type</span> <span class="at">:seq</span>}))]</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">-&gt;</span> no-missing-values</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>      (tc/map-columns <span class="at">:id</span> [<span class="at">:assessment-account-number</span> <span class="at">:sale-date</span>] <span class="kw">vector</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>      (tc/inner-join potentially-duplicate-row-ids <span class="at">:id</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>      (tc/drop-columns <span class="at">:id</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>      (tc/order-by [<span class="at">:assessment-account-number</span> <span class="at">:sale-date</span>])</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>      (tc/drop-rows #(<span class="kw">&gt;</span> (<span class="at">:living-units</span> <span class="va">%</span>) <span class="dv">1</span>))</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>      <span class="co">;; (tc/select-columns [:assessment-account-number :sale-date :sale-price])</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>      (tc/fold-by [<span class="at">:assessment-account-number</span> <span class="at">:sale-date</span>])</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>      (tc/select-rows #(<span class="kw">not</span> (<span class="kw">apply</span> <span class="kw">=</span> (<span class="at">:sale-price</span> <span class="va">%</span>))))</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>      (tc/unroll [<span class="at">:sale-price</span>])))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [301 24]:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 5%">
<col style="width: 2%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 13%">
<col style="width: 2%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">:assessment-account-number</th>
<th>:sale-date</th>
<th>:building-type</th>
<th>:civic-street-name</th>
<th>:square-foot-living-area</th>
<th>:civic-city-name</th>
<th>:civic-additional</th>
<th>:civic-direction</th>
<th>:under-construction</th>
<th>:civic-suffix</th>
<th>:parcels-in-sale</th>
<th>:garage</th>
<th>:stories</th>
<th>:construction-grade</th>
<th>:year-built</th>
<th>:finished-basement</th>
<th>:civic-number</th>
<th>:bedrooms</th>
<th>:count</th>
<th>:square-feet</th>
<th>:bathrooms</th>
<th>:living-units</th>
<th>:municipal-unit</th>
<th style="text-align: right;">:sale-price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">18341</td>
<td>2016-08-01</td>
<td>[Detached Detached]</td>
<td>[MAIN MAIN]</td>
<td>[972 972]</td>
<td>[KENTVILLE KENTVILLE]</td>
<td>[]</td>
<td>[]</td>
<td>[false false]</td>
<td>[ST ST]</td>
<td>[1 1]</td>
<td>[false false]</td>
<td>[1.5 1.5]</td>
<td>[Average Average]</td>
<td>[1888 1888]</td>
<td>[false false]</td>
<td>[242 242]</td>
<td>[3 3]</td>
<td>[2 2]</td>
<td>[4413 4413]</td>
<td>[2 2]</td>
<td>[1 1]</td>
<td>[TOWN OF KENTVILLE TOWN OF KENTVILLE]</td>
<td style="text-align: right;">93000</td>
</tr>
<tr class="even">
<td style="text-align: right;">18341</td>
<td>2016-08-01</td>
<td>[Detached Detached]</td>
<td>[MAIN MAIN]</td>
<td>[972 972]</td>
<td>[KENTVILLE KENTVILLE]</td>
<td>[]</td>
<td>[]</td>
<td>[false false]</td>
<td>[ST ST]</td>
<td>[1 1]</td>
<td>[false false]</td>
<td>[1.5 1.5]</td>
<td>[Average Average]</td>
<td>[1888 1888]</td>
<td>[false false]</td>
<td>[242 242]</td>
<td>[3 3]</td>
<td>[2 2]</td>
<td>[4413 4413]</td>
<td>[2 2]</td>
<td>[1 1]</td>
<td>[TOWN OF KENTVILLE TOWN OF KENTVILLE]</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">53155</td>
<td>2017-12-05</td>
<td>[Detached Detached]</td>
<td>[ALLEN ALLEN]</td>
<td>[600 600]</td>
<td>[PORT GREVILLE PORT GREVILLE]</td>
<td>[]</td>
<td>[]</td>
<td>[false false]</td>
<td>[RD RD]</td>
<td>[1 1]</td>
<td>[false false]</td>
<td>[1.0 1.0]</td>
<td>[Low Low]</td>
<td>[1973 1973]</td>
<td>[false false]</td>
<td>[78 78]</td>
<td>[1 1]</td>
<td>[2 2]</td>
<td>[21780 21780]</td>
<td>[1 1]</td>
<td>[1 1]</td>
<td>[MUNICIPALITY OF THE COUNTY OF CUMBERLAND</td>
<td style="text-align: right;">1200</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>MUNICIPALITY OF THE COUNTY OF CUMBERLAND]</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">53155</td>
<td>2017-12-05</td>
<td>[Detached Detached]</td>
<td>[ALLEN ALLEN]</td>
<td>[600 600]</td>
<td>[PORT GREVILLE PORT GREVILLE]</td>
<td>[]</td>
<td>[]</td>
<td>[false false]</td>
<td>[RD RD]</td>
<td>[1 1]</td>
<td>[false false]</td>
<td>[1.0 1.0]</td>
<td>[Low Low]</td>
<td>[1973 1973]</td>
<td>[false false]</td>
<td>[78 78]</td>
<td>[1 1]</td>
<td>[2 2]</td>
<td>[21780 21780]</td>
<td>[1 1]</td>
<td>[1 1]</td>
<td>[MUNICIPALITY OF THE COUNTY OF CUMBERLAND</td>
<td style="text-align: right;">41310</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>MUNICIPALITY OF THE COUNTY OF CUMBERLAND]</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">87246</td>
<td>2017-06-15</td>
<td>[Semi Detached Semi Detached]</td>
<td>[WOOD WOOD]</td>
<td>[720 720]</td>
<td>[NEW WATERFORD NEW WATERFORD]</td>
<td>[]</td>
<td>[]</td>
<td>[false false]</td>
<td>[AVE AVE]</td>
<td>[1 1]</td>
<td>[false false]</td>
<td>[1.5 1.5]</td>
<td>[Average Average]</td>
<td>[1910 1910]</td>
<td>[false false]</td>
<td>[3516 3516]</td>
<td>[2 2]</td>
<td>[2 2]</td>
<td>[4932 4932]</td>
<td>[1 1]</td>
<td>[1 1]</td>
<td>[CAPE BRETON REGIONAL MUNICIPALITY (CBRM)</td>
<td style="text-align: right;">39000</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>CAPE BRETON REGIONAL MUNICIPALITY (CBRM)]</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">87246</td>
<td>2017-06-15</td>
<td>[Semi Detached Semi Detached]</td>
<td>[WOOD WOOD]</td>
<td>[720 720]</td>
<td>[NEW WATERFORD NEW WATERFORD]</td>
<td>[]</td>
<td>[]</td>
<td>[false false]</td>
<td>[AVE AVE]</td>
<td>[1 1]</td>
<td>[false false]</td>
<td>[1.5 1.5]</td>
<td>[Average Average]</td>
<td>[1910 1910]</td>
<td>[false false]</td>
<td>[3516 3516]</td>
<td>[2 2]</td>
<td>[2 2]</td>
<td>[4932 4932]</td>
<td>[1 1]</td>
<td>[1 1]</td>
<td>[CAPE BRETON REGIONAL MUNICIPALITY (CBRM)</td>
<td style="text-align: right;">24000</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>CAPE BRETON REGIONAL MUNICIPALITY (CBRM)]</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">97004</td>
<td>2024-04-01</td>
<td>[Detached Detached]</td>
<td>[MILL VILLAGE EAST MILL VILLAGE EAST]</td>
<td>[680 680]</td>
<td>[CHARLESTON CHARLESTON]</td>
<td>[]</td>
<td>[]</td>
<td>[false false]</td>
<td>[RD RD]</td>
<td>[1 1]</td>
<td>[false false]</td>
<td>[1.0 1.0]</td>
<td>[Average Average]</td>
<td>[1932 1932]</td>
<td>[false false]</td>
<td>[606 606]</td>
<td>[3 3]</td>
<td>[2 2]</td>
<td>[10890 10890]</td>
<td>[1 1]</td>
<td>[1 1]</td>
<td>[QUEENS, REGION OF QUEENS MUNICIPALITY</td>
<td style="text-align: right;">138434</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>QUEENS, REGION OF QUEENS MUNICIPALITY]</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">97004</td>
<td>2024-04-01</td>
<td>[Detached Detached]</td>
<td>[MILL VILLAGE EAST MILL VILLAGE EAST]</td>
<td>[680 680]</td>
<td>[CHARLESTON CHARLESTON]</td>
<td>[]</td>
<td>[]</td>
<td>[false false]</td>
<td>[RD RD]</td>
<td>[1 1]</td>
<td>[false false]</td>
<td>[1.0 1.0]</td>
<td>[Average Average]</td>
<td>[1932 1932]</td>
<td>[false false]</td>
<td>[606 606]</td>
<td>[3 3]</td>
<td>[2 2]</td>
<td>[10890 10890]</td>
<td>[1 1]</td>
<td>[1 1]</td>
<td>[QUEENS, REGION OF QUEENS MUNICIPALITY</td>
<td style="text-align: right;">34609</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>QUEENS, REGION OF QUEENS MUNICIPALITY]</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">133949</td>
<td>2012-01-24</td>
<td>[Detached Detached]</td>
<td>[HIGHWAY 8 HIGHWAY 8]</td>
<td>[627 627]</td>
<td>[KEMPT KEMPT]</td>
<td>[]</td>
<td>[]</td>
<td>[false false]</td>
<td>[]</td>
<td>[1 1]</td>
<td>[false false]</td>
<td>[1.5 1.5]</td>
<td>[Average Average]</td>
<td>[1943 1943]</td>
<td>[false false]</td>
<td>[12153 12153]</td>
<td>[3 3]</td>
<td>[2 2]</td>
<td>[130680 130680]</td>
<td>[1 1]</td>
<td>[1 1]</td>
<td>[QUEENS, REGION OF QUEENS MUNICIPALITY</td>
<td style="text-align: right;">700</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>QUEENS, REGION OF QUEENS MUNICIPALITY]</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">133949</td>
<td>2012-01-24</td>
<td>[Detached Detached]</td>
<td>[HIGHWAY 8 HIGHWAY 8]</td>
<td>[627 627]</td>
<td>[KEMPT KEMPT]</td>
<td>[]</td>
<td>[]</td>
<td>[false false]</td>
<td>[]</td>
<td>[1 1]</td>
<td>[false false]</td>
<td>[1.5 1.5]</td>
<td>[Average Average]</td>
<td>[1943 1943]</td>
<td>[false false]</td>
<td>[12153 12153]</td>
<td>[3 3]</td>
<td>[2 2]</td>
<td>[130680 130680]</td>
<td>[1 1]</td>
<td>[1 1]</td>
<td>[QUEENS, REGION OF QUEENS MUNICIPALITY</td>
<td style="text-align: right;">625</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>QUEENS, REGION OF QUEENS MUNICIPALITY]</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td style="text-align: right;">10679354</td>
<td>2017-05-03</td>
<td>[Detached Detached]</td>
<td>[TRANSOM TRANSOM]</td>
<td>[3679 3679]</td>
<td>[HALIFAX HALIFAX]</td>
<td>[]</td>
<td>[]</td>
<td>[false false]</td>
<td>[DR DR]</td>
<td>[1 1]</td>
<td>[false false]</td>
<td>[2.0 2.0]</td>
<td>[Good Good]</td>
<td>[2016 2016]</td>
<td>[true true]</td>
<td>[321 321]</td>
<td>[4 4]</td>
<td>[2 2]</td>
<td>[5379 5379]</td>
<td>[4 4]</td>
<td>[1 1]</td>
<td>[HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">570000</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)]</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">10905206</td>
<td>2021-12-21</td>
<td>[Detached Detached]</td>
<td>[TALUS TALUS]</td>
<td>[4528 4528]</td>
<td>[BEDFORD BEDFORD]</td>
<td>[]</td>
<td>[]</td>
<td>[false false]</td>
<td>[AVE AVE]</td>
<td>[1 1]</td>
<td>[false false]</td>
<td>[2.0 2.0]</td>
<td>[Good Good]</td>
<td>[2021 2021]</td>
<td>[true true]</td>
<td>[166 166]</td>
<td>[5 5]</td>
<td>[2 2]</td>
<td>[6458 6458]</td>
<td>[5 5]</td>
<td>[1 1]</td>
<td>[HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">1015000</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)]</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">10905206</td>
<td>2021-12-21</td>
<td>[Detached Detached]</td>
<td>[TALUS TALUS]</td>
<td>[4528 4528]</td>
<td>[BEDFORD BEDFORD]</td>
<td>[]</td>
<td>[]</td>
<td>[false false]</td>
<td>[AVE AVE]</td>
<td>[1 1]</td>
<td>[false false]</td>
<td>[2.0 2.0]</td>
<td>[Good Good]</td>
<td>[2021 2021]</td>
<td>[true true]</td>
<td>[166 166]</td>
<td>[5 5]</td>
<td>[2 2]</td>
<td>[6458 6458]</td>
<td>[5 5]</td>
<td>[1 1]</td>
<td>[HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">930355</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)]</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">10905311</td>
<td>2021-12-22</td>
<td>[Detached Detached]</td>
<td>[TALUS TALUS]</td>
<td>[3012 3012]</td>
<td>[BEDFORD BEDFORD]</td>
<td>[]</td>
<td>[]</td>
<td>[false false]</td>
<td>[AVE AVE]</td>
<td>[1 1]</td>
<td>[true true]</td>
<td>[2.0 2.0]</td>
<td>[Good Good]</td>
<td>[2021 2021]</td>
<td>[true true]</td>
<td>[199 199]</td>
<td>[4 4]</td>
<td>[2 2]</td>
<td>[6364 6364]</td>
<td>[5 5]</td>
<td>[1 1]</td>
<td>[HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">699943</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)]</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">10905311</td>
<td>2021-12-22</td>
<td>[Detached Detached]</td>
<td>[TALUS TALUS]</td>
<td>[3012 3012]</td>
<td>[BEDFORD BEDFORD]</td>
<td>[]</td>
<td>[]</td>
<td>[false false]</td>
<td>[AVE AVE]</td>
<td>[1 1]</td>
<td>[true true]</td>
<td>[2.0 2.0]</td>
<td>[Good Good]</td>
<td>[2021 2021]</td>
<td>[true true]</td>
<td>[199 199]</td>
<td>[4 4]</td>
<td>[2 2]</td>
<td>[6364 6364]</td>
<td>[5 5]</td>
<td>[1 1]</td>
<td>[HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">880000</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)]</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">10939399</td>
<td>2022-01-10</td>
<td>[Semi Detached Semi Detached]</td>
<td>[GALA GALA]</td>
<td>[1462 1462]</td>
<td>[BERWICK BERWICK]</td>
<td>[]</td>
<td>[]</td>
<td>[false false]</td>
<td>[DR DR]</td>
<td>[1 2]</td>
<td>[true true]</td>
<td>[1.0 1.0]</td>
<td>[Average Average]</td>
<td>[2021 2021]</td>
<td>[false false]</td>
<td>[12 12]</td>
<td>[3 3]</td>
<td>[2 2]</td>
<td>[6738 6738]</td>
<td>[2 2]</td>
<td>[1 1]</td>
<td>[TOWN OF BERWICK TOWN OF BERWICK]</td>
<td style="text-align: right;">361828</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10939399</td>
<td>2022-01-10</td>
<td>[Semi Detached Semi Detached]</td>
<td>[GALA GALA]</td>
<td>[1462 1462]</td>
<td>[BERWICK BERWICK]</td>
<td>[]</td>
<td>[]</td>
<td>[false false]</td>
<td>[DR DR]</td>
<td>[1 2]</td>
<td>[true true]</td>
<td>[1.0 1.0]</td>
<td>[Average Average]</td>
<td>[2021 2021]</td>
<td>[false false]</td>
<td>[12 12]</td>
<td>[3 3]</td>
<td>[2 2]</td>
<td>[6738 6738]</td>
<td>[2 2]</td>
<td>[1 1]</td>
<td>[TOWN OF BERWICK TOWN OF BERWICK]</td>
<td style="text-align: right;">70000</td>
</tr>
<tr class="even">
<td style="text-align: right;">10939429</td>
<td>2022-06-30</td>
<td>[Semi Detached Semi Detached]</td>
<td>[GALA GALA]</td>
<td>[1462 1462]</td>
<td>[BERWICK BERWICK]</td>
<td>[]</td>
<td>[]</td>
<td>[false false]</td>
<td>[DR DR]</td>
<td>[2 1]</td>
<td>[true true]</td>
<td>[1.0 1.0]</td>
<td>[Average Average]</td>
<td>[2021 2021]</td>
<td>[false false]</td>
<td>[13 13]</td>
<td>[3 3]</td>
<td>[2 2]</td>
<td>[7693 7693]</td>
<td>[2 2]</td>
<td>[1 1]</td>
<td>[TOWN OF BERWICK TOWN OF BERWICK]</td>
<td style="text-align: right;">70000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10939429</td>
<td>2022-06-30</td>
<td>[Semi Detached Semi Detached]</td>
<td>[GALA GALA]</td>
<td>[1462 1462]</td>
<td>[BERWICK BERWICK]</td>
<td>[]</td>
<td>[]</td>
<td>[false false]</td>
<td>[DR DR]</td>
<td>[2 1]</td>
<td>[true true]</td>
<td>[1.0 1.0]</td>
<td>[Average Average]</td>
<td>[2021 2021]</td>
<td>[false false]</td>
<td>[13 13]</td>
<td>[3 3]</td>
<td>[2 2]</td>
<td>[7693 7693]</td>
<td>[2 2]</td>
<td>[1 1]</td>
<td>[TOWN OF BERWICK TOWN OF BERWICK]</td>
<td style="text-align: right;">337283</td>
</tr>
<tr class="even">
<td style="text-align: right;">10969220</td>
<td>2022-02-24</td>
<td>[Semi Detached Semi Detached]</td>
<td>[ELIZABETH ELIZABETH]</td>
<td>[1302 1302]</td>
<td>[GARLANDS CROSSING GARLANDS CROSSING]</td>
<td>[]</td>
<td>[]</td>
<td>[false false]</td>
<td>[AVE AVE]</td>
<td>[1 4]</td>
<td>[true true]</td>
<td>[1.0 1.0]</td>
<td>[Average Average]</td>
<td>[2021 2021]</td>
<td>[false false]</td>
<td>[36 36]</td>
<td>[2 2]</td>
<td>[2 2]</td>
<td>[5016 5016]</td>
<td>[2 2]</td>
<td>[1 1]</td>
<td>[WEST HANTS REGIONAL MUNICIPALITY WEST HANTS REGIONAL MUNICIPALITY]</td>
<td style="text-align: right;">330955</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10969220</td>
<td>2022-02-24</td>
<td>[Semi Detached Semi Detached]</td>
<td>[ELIZABETH ELIZABETH]</td>
<td>[1302 1302]</td>
<td>[GARLANDS CROSSING GARLANDS CROSSING]</td>
<td>[]</td>
<td>[]</td>
<td>[false false]</td>
<td>[AVE AVE]</td>
<td>[1 4]</td>
<td>[true true]</td>
<td>[1.0 1.0]</td>
<td>[Average Average]</td>
<td>[2021 2021]</td>
<td>[false false]</td>
<td>[36 36]</td>
<td>[2 2]</td>
<td>[2 2]</td>
<td>[5016 5016]</td>
<td>[2 2]</td>
<td>[1 1]</td>
<td>[WEST HANTS REGIONAL MUNICIPALITY WEST HANTS REGIONAL MUNICIPALITY]</td>
<td style="text-align: right;">240000</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>We want to select the rows that indicate potentially duplicate sales in our original dataset and see what’s going on, so first we’ll create a new ID column that combines the assessment account number and sale date to help us identify potentially duplicate rows, then we’ll select the rows from the original dataset that match these unique ID values and examine these rows to understand what’s going on with the potential duplicates.</p>
<p>To efficiently filter our original dataset by the new ID column we’re adding, we can use an inner-join, to only include rows from the target dataset that have an id in our source dataset. First we’ll create the same composite ID column on our original dataset, then join it with the one the one containing our IDs of interest to efficiently filter by these IDs.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb41"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> duplicate-rows</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">let</span> [potentially-duplicate-row-ids (<span class="kw">-&gt;</span> potentially-duplicate-row-counts</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                                          (tc/join-columns <span class="at">:id</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                                                           [<span class="at">:assessment-account-number</span> <span class="at">:sale-date</span>]</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                                                           {<span class="at">:result-type</span> <span class="at">:seq</span>}))]</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">-&gt;</span> partially-cleaned-housing-data</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>        (tc/map-columns <span class="at">:id</span> [<span class="at">:assessment-account-number</span> <span class="at">:sale-date</span>] <span class="kw">vector</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>        (tc/inner-join potentially-duplicate-row-ids <span class="at">:id</span>)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>        (tc/drop-columns <span class="at">:id</span>)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>        (tc/order-by <span class="at">:assessment-account-number</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can check that this did what we expected by summing up the counts from our potentially duplicate sales dataset. It should equal the number of rows in our filtered original dataset:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb42"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">reduce</span> <span class="kw">+</span> (<span class="at">:count</span> potentially-duplicate-row-counts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb43"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2184</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb44"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>(tc/row-count duplicate-rows)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb45"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2294</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we need to handle these duplicate rows. We can just blindly delete them, but it’s better to try to understand what’s going on, in case there’s some valid reason for them to be duplicated, or something else we’re misunderstanding about our data. Eyeballing the data reveals some interesting things, like that some rows have a <code>living-units</code> value that isn’t 1 and some have multiple different <code>year-built</code> values for the same unit, but some visualisations will help to reveal more about the data.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb46"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>duplicate-rows</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>inner-join [2294 24]:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 1%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">:assessment-account-number</th>
<th>:municipal-unit</th>
<th style="text-align: right;">:civic-number</th>
<th>:civic-additional</th>
<th>:civic-direction</th>
<th>:civic-street-name</th>
<th>:civic-suffix</th>
<th>:civic-city-name</th>
<th style="text-align: right;">:sale-price</th>
<th>:sale-date</th>
<th style="text-align: right;">:parcels-in-sale</th>
<th style="text-align: right;">:living-units</th>
<th style="text-align: right;">:year-built</th>
<th style="text-align: right;">:square-foot-living-area</th>
<th style="text-align: right;">:stories</th>
<th>:building-type</th>
<th style="text-align: right;">:bedrooms</th>
<th style="text-align: right;">:bathrooms</th>
<th>:under-construction</th>
<th>:construction-grade</th>
<th>:finished-basement</th>
<th>:garage</th>
<th style="text-align: right;">:square-feet</th>
<th style="text-align: right;">:count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">9075</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td style="text-align: right;">491</td>
<td></td>
<td></td>
<td>OAKLAND</td>
<td>RD</td>
<td>INDIAN POINT</td>
<td style="text-align: right;">170000</td>
<td>2018-11-02</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1977</td>
<td style="text-align: right;">1390</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">67954</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">9075</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td style="text-align: right;">491</td>
<td></td>
<td></td>
<td>OAKLAND</td>
<td>RD</td>
<td>INDIAN POINT</td>
<td style="text-align: right;">170000</td>
<td>2018-11-02</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">668</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">67954</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9075</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td style="text-align: right;">491</td>
<td></td>
<td></td>
<td>OAKLAND</td>
<td>RD</td>
<td>INDIAN POINT</td>
<td style="text-align: right;">155000</td>
<td>2014-08-06</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1977</td>
<td style="text-align: right;">1390</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">67954</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">9075</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td style="text-align: right;">491</td>
<td></td>
<td></td>
<td>OAKLAND</td>
<td>RD</td>
<td>INDIAN POINT</td>
<td style="text-align: right;">155000</td>
<td>2014-08-06</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">668</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">67954</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">18341</td>
<td>TOWN OF KENTVILLE</td>
<td style="text-align: right;">242</td>
<td></td>
<td></td>
<td>MAIN</td>
<td>ST</td>
<td>KENTVILLE</td>
<td style="text-align: right;">1000</td>
<td>2016-08-01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1888</td>
<td style="text-align: right;">972</td>
<td style="text-align: right;">1.5</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">4413</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">18341</td>
<td>TOWN OF KENTVILLE</td>
<td style="text-align: right;">242</td>
<td></td>
<td></td>
<td>MAIN</td>
<td>ST</td>
<td>KENTVILLE</td>
<td style="text-align: right;">93000</td>
<td>2016-08-01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1888</td>
<td style="text-align: right;">972</td>
<td style="text-align: right;">1.5</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">4413</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">43397</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">775</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>MOUNT UNIACKE</td>
<td style="text-align: right;">123000</td>
<td>2015-10-29</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1903</td>
<td style="text-align: right;">864</td>
<td style="text-align: right;">1.5</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">15893</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">43397</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">775</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>MOUNT UNIACKE</td>
<td style="text-align: right;">123000</td>
<td>2015-10-29</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1008</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td>true</td>
<td>Average</td>
<td>true</td>
<td>true</td>
<td style="text-align: right;">15893</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">44296</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">6555</td>
<td></td>
<td></td>
<td>CHESTER</td>
<td>AVE</td>
<td>HALIFAX</td>
<td style="text-align: right;">315000</td>
<td>2017-01-07</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1943</td>
<td style="text-align: right;">1710</td>
<td style="text-align: right;">2.0</td>
<td>Detached</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">4343</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">44296</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">6555</td>
<td></td>
<td></td>
<td>CHESTER</td>
<td>AVE</td>
<td>HALIFAX</td>
<td style="text-align: right;">1200</td>
<td>2017-01-07</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1943</td>
<td style="text-align: right;">1710</td>
<td style="text-align: right;">2.0</td>
<td>Detached</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">4343</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td style="text-align: right;">10939399</td>
<td>TOWN OF BERWICK</td>
<td style="text-align: right;">12</td>
<td></td>
<td></td>
<td>GALA</td>
<td>DR</td>
<td>BERWICK</td>
<td style="text-align: right;">361828</td>
<td>2022-01-10</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1462</td>
<td style="text-align: right;">1.0</td>
<td>Semi Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">6738</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10939429</td>
<td>TOWN OF BERWICK</td>
<td style="text-align: right;">13</td>
<td></td>
<td></td>
<td>GALA</td>
<td>DR</td>
<td>BERWICK</td>
<td style="text-align: right;">337283</td>
<td>2022-06-30</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1462</td>
<td style="text-align: right;">1.0</td>
<td>Semi Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">7693</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">10939429</td>
<td>TOWN OF BERWICK</td>
<td style="text-align: right;">13</td>
<td></td>
<td></td>
<td>GALA</td>
<td>DR</td>
<td>BERWICK</td>
<td style="text-align: right;">70000</td>
<td>2022-06-30</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1462</td>
<td style="text-align: right;">1.0</td>
<td>Semi Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">7693</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10944831</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">426</td>
<td></td>
<td></td>
<td>ESS</td>
<td>RD</td>
<td>UPPER NINE MILE RIVER</td>
<td style="text-align: right;">20000</td>
<td>2021-12-06</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1344</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">437725</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">10944831</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">426</td>
<td></td>
<td></td>
<td>ESS</td>
<td>RD</td>
<td>UPPER NINE MILE RIVER</td>
<td style="text-align: right;">20000</td>
<td>2021-12-06</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">1264</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">437725</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10969220</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">36</td>
<td></td>
<td></td>
<td>ELIZABETH</td>
<td>AVE</td>
<td>GARLANDS CROSSING</td>
<td style="text-align: right;">240000</td>
<td>2022-02-24</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1302</td>
<td style="text-align: right;">1.0</td>
<td>Semi Detached</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">5016</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">10969220</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">36</td>
<td></td>
<td></td>
<td>ELIZABETH</td>
<td>AVE</td>
<td>GARLANDS CROSSING</td>
<td style="text-align: right;">330955</td>
<td>2022-02-24</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1302</td>
<td style="text-align: right;">1.0</td>
<td>Semi Detached</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">5016</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10991625</td>
<td>MUNICIPALITY OF THE COUNTY OF INVERNESS</td>
<td style="text-align: right;">2581</td>
<td></td>
<td></td>
<td>SHORE</td>
<td>RD</td>
<td>MARGAREE HARBOUR</td>
<td style="text-align: right;">600000</td>
<td>2022-06-03</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1985</td>
<td style="text-align: right;">552</td>
<td style="text-align: right;">1.0</td>
<td>Detached</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>false</td>
<td>Average</td>
<td>false</td>
<td>false</td>
<td style="text-align: right;">125986</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">10991625</td>
<td>MUNICIPALITY OF THE COUNTY OF INVERNESS</td>
<td style="text-align: right;">2581</td>
<td></td>
<td></td>
<td>SHORE</td>
<td>RD</td>
<td>MARGAREE HARBOUR</td>
<td style="text-align: right;">600000</td>
<td>2022-06-03</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1970</td>
<td style="text-align: right;">2380</td>
<td style="text-align: right;">1.5</td>
<td>Detached</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td>false</td>
<td>Average</td>
<td>true</td>
<td>false</td>
<td style="text-align: right;">125986</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11021141</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">57</td>
<td></td>
<td></td>
<td>BRIANNA</td>
<td>DR</td>
<td>LANTZ</td>
<td style="text-align: right;">600000</td>
<td>2023-04-28</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">2005</td>
<td style="text-align: right;">2.0</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td>true</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">11320</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">11021141</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">57</td>
<td></td>
<td></td>
<td>BRIANNA</td>
<td>DR</td>
<td>LANTZ</td>
<td style="text-align: right;">600000</td>
<td>2023-04-28</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">2029</td>
<td style="text-align: right;">2.0</td>
<td>Detached</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td>true</td>
<td>Average</td>
<td>false</td>
<td>true</td>
<td style="text-align: right;">11320</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
<p>We’ll use <a href="https://github.com/scicloj/hanamicloth">hanamicloth</a> for our data visualisation. First we can check out the distribution of living unit sizes:</p>
<p>(-&gt; duplicate-rows (ploclo/layer-histogram {:=x :living-units}) )</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb47"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> partially-cleaned-housing-data</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    (tc/unique-by [<span class="at">:assessment-account-number</span> <span class="at">:sale-date</span>])</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    tc/row-count</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb48"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="dv">345716</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>clean up and steps to turn this data into <a href="">tidy data</a> before saving it to work with in the next steps.</p>
<p>First, we can</p>
<p>If we inspect this new, combined dataset we can see there are quite a few sparse columns:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb49"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> housing-data</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    tc/info</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows #(<span class="kw">&lt;</span> <span class="dv">0</span> (<span class="at">:n-missing</span> <span class="va">%</span>)))</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns [<span class="at">:col-name</span> <span class="at">:n-missing</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>inner-join: descriptive-stats [14 2]:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>:col-name</th>
<th style="text-align: right;">:n-missing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:civic-number</td>
<td style="text-align: right;">3456</td>
</tr>
<tr class="even">
<td>:civic-additional</td>
<td style="text-align: right;">361858</td>
</tr>
<tr class="odd">
<td>:civic-direction</td>
<td style="text-align: right;">361775</td>
</tr>
<tr class="even">
<td>:civic-street-name</td>
<td style="text-align: right;">94</td>
</tr>
<tr class="odd">
<td>:civic-suffix</td>
<td style="text-align: right;">36727</td>
</tr>
<tr class="even">
<td>:civic-city-name</td>
<td style="text-align: right;">98</td>
</tr>
<tr class="odd">
<td>:sale-price</td>
<td style="text-align: right;">1116</td>
</tr>
<tr class="even">
<td>:parcels-in-sale</td>
<td style="text-align: right;">3774</td>
</tr>
<tr class="odd">
<td>:year-built</td>
<td style="text-align: right;">47337</td>
</tr>
<tr class="even">
<td>:square-foot-living-area</td>
<td style="text-align: right;">17512</td>
</tr>
<tr class="odd">
<td>:style</td>
<td style="text-align: right;">17407</td>
</tr>
<tr class="even">
<td>:bedrooms</td>
<td style="text-align: right;">36486</td>
</tr>
<tr class="odd">
<td>:construction-grade</td>
<td style="text-align: right;">17635</td>
</tr>
<tr class="even">
<td>:square-feet</td>
<td style="text-align: right;">13451</td>
</tr>
</tbody>
</table>
</div>
<p>Some of these were columns that were in more than one of the original dataset and in combining them, by taking only the value from the first dataset, we may have lost some information. We can tell this by checking the descriptive stats of one of the other datasets, which shows different numbers of missing values:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb50"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> characteristics</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    tc/info</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows #(<span class="kw">&lt;</span> <span class="dv">0</span> (<span class="at">:n-missing</span> <span class="va">%</span>)))</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns [<span class="at">:col-name</span> <span class="at">:n-missing</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>characteristics: descriptive-stats [14 2]:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>:col-name</th>
<th style="text-align: right;">:n-missing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:civic-number</td>
<td style="text-align: right;">4967</td>
</tr>
<tr class="even">
<td>:civic-additional</td>
<td style="text-align: right;">377922</td>
</tr>
<tr class="odd">
<td>:civic-direction</td>
<td style="text-align: right;">377760</td>
</tr>
<tr class="even">
<td>:civic-street-name</td>
<td style="text-align: right;">550</td>
</tr>
<tr class="odd">
<td>:civic-street-suffix</td>
<td style="text-align: right;">40669</td>
</tr>
<tr class="even">
<td>:civic-city-name</td>
<td style="text-align: right;">492</td>
</tr>
<tr class="odd">
<td>:year-built</td>
<td style="text-align: right;">49663</td>
</tr>
<tr class="even">
<td>:square-foot-living-area</td>
<td style="text-align: right;">12753</td>
</tr>
<tr class="odd">
<td>:style</td>
<td style="text-align: right;">12656</td>
</tr>
<tr class="even">
<td>:bedrooms</td>
<td style="text-align: right;">52235</td>
</tr>
<tr class="odd">
<td>:construction-grade</td>
<td style="text-align: right;">12832</td>
</tr>
<tr class="even">
<td>:y-map-coordinate</td>
<td style="text-align: right;">24115</td>
</tr>
<tr class="odd">
<td>:x-map-coordinate</td>
<td style="text-align: right;">24115</td>
</tr>
<tr class="even">
<td>:map-coordinates</td>
<td style="text-align: right;">24115</td>
</tr>
</tbody>
</table>
</div>
<p>In this case there are more missing values in the <code>characteristics</code> dataset than in the combined one, so it may be the case that there isn’t actually any extra information in the characteristics dataset, but to be sure we can check. To do that we’ll combine the three datasets, then check the columns we care about for any rows where the value from the first dataset is <code>nil</code>, but either of the other two have a value.</p>
<p>First, to simplify some of this code we’ll define the list of columns the datasets share:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb51"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> common-columns</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  [<span class="at">:assessment-account-number</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">:municipal-unit</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">:civic-number</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>   <span class="at">:civic-additional</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>   <span class="at">:civic-direction</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>   <span class="at">:civic-street-name</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>   <span class="at">:civic-suffix</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>   <span class="at">:civic-city-name</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we can join the datasets together, keeping the duplicated columns this time. Tablecloth will default to disambiguating the duplicated column names by using the dataset names, which works fine in this case:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb52"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> combined-potentially-duplicated-columns</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">-&gt;</span> sales-history</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>      (tc/select-columns common-columns)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>      (tc/inner-join (tc/select-columns characteristics common-columns)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">:assessment-account-number</span>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>      (tc/inner-join (tc/select-columns land-sizes common-columns)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">:assessment-account-number</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can check whether any of the other datasets have information for the missing values. For the sake of demonstration we’ll check the <code>:municipal-unit</code> column first:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb53"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> combined-potentially-duplicated-columns</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows (<span class="kw">fn</span> [row]</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                      (<span class="kw">let</span> [v1 (<span class="at">:municipal-unit</span> row)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                            v2 (<span class="at">:characteristics.municipal-unit</span> row)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>                            v3 (<span class="at">:land-sizes.municipal-unit</span> row)]</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>                        (<span class="kw">and</span> (<span class="kw">nil?</span> v1)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>                             (<span class="kw">not</span> (<span class="kw">nil?</span> (<span class="kw">or</span> v2 v3))))))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>inner-join [0 20]:</p>
<table class="caption-top" style="width:100%;">
<colgroup>
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">:assessment-account-number</th>
<th>:municipal-unit</th>
<th style="text-align: right;">:civic-number</th>
<th>:civic-additional</th>
<th>:civic-direction</th>
<th>:civic-street-name</th>
<th>:civic-suffix</th>
<th>:civic-city-name</th>
<th>:characteristics.municipal-unit</th>
<th style="text-align: right;">:characteristics.civic-number</th>
<th>:characteristics.civic-additional</th>
<th>:characteristics.civic-direction</th>
<th>:characteristics.civic-street-name</th>
<th>:characteristics.civic-city-name</th>
<th>:land-sizes.municipal-unit</th>
<th style="text-align: right;">:land-sizes.civic-number</th>
<th>:land-sizes.civic-additional</th>
<th>:land-sizes.civic-direction</th>
<th>:land-sizes.civic-street-name</th>
<th>:land-sizes.civic-city-name</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
<p>It turns out there are actually no rows that have a missing value for <code>:municipal-unit</code> in the <code>sales-history</code> dataset but do have a value in either of the other two datasets. To check the rest of the columns more quickly we can extract our predicate into a helper and have it accept a column name as an argument. This function will take a row and a column name and return <code>true</code> if our primary dataset has no value in the given row and column and either of the secondary datasets contain do have a value:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb54"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn-</span><span class="fu"> non-nil-in-secondary-datasets? </span>[row col-name]</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">let</span> [v1 (col-name row)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>        v2 ((<span class="kw">-&gt;&gt;</span> col-name <span class="kw">name</span> (<span class="kw">str</span> <span class="st">"characteristics."</span>) <span class="kw">keyword</span>) row)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>        v3 ((<span class="kw">-&gt;&gt;</span> col-name <span class="kw">name</span> (<span class="kw">str</span> <span class="st">"land-sizes."</span>) <span class="kw">keyword</span>) row)]</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">and</span> (<span class="kw">nil?</span> v1)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>         (<span class="kw">not</span> (<span class="kw">nil?</span> (<span class="kw">or</span> v2 v3))))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb55"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="va">#'book.part-0-end-to-end.1-data-import-and-cleanup-example/non-nil-in-secondary-datasets?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And it order to check all the column names at ones, we can run this check over a given list of column names we want to check:</p>
<p>(defn- check-for-values-in-secondary-datasets [ds column-names] (reduce (fn [ds col-namel] () ds column-names)))</p>
<p>(defn secondary-datsets-have-missing-data [column-names row] (some identity (reduce (fn [row col-name] (non-nil-in-secondary-datasets? row col-name)) row column-names)))</p>
<p>(-&gt; combined-potentially-duplicated-columns (tc/select-rows (partial secondary-datsets-have-missing-data common-columns)))</p>
<p>Now we’ll go through and try to fill in as much information as possible. We can start by filtering out any rows that do not have missing values in our base dataset in the columns we’re trying to fill in. To keep our processing pipeline neat, we’ll write a simple helper that will return true for rows that fit our criteria:</p>
<p>(defn resolve [v1 v2 v3] ;; (some identity args) (or v1 v2 v3) )</p>
<p>(defn consolidate-columns [ds column-names] (reduce (fn [ds col-name] (let [characteristics-col-name (-&gt;&gt; col-name name (str “characteristics.”) keyword) land-sizes-col-name (-&gt;&gt; col-name name (str “land-sizes.”) keyword)] (-&gt; ds (tc/map-columns col-name [col-name characteristics-col-name land-sizes-col-name] resolve) (tc/drop-columns [characteristics-col-name land-sizes-col-name])))) ds column-names))</p>
<p>(-&gt; combined-potentially-duplicated-columns ;; (tc/head 4) (consolidate-columns common-columns) tc/info (tc/select-rows #(&lt; 0 (:n-missing %))) (tc/select-columns [:col-name :n-missing]))</p>
<p>(defn no-missing-info)</p>
<p>(-&gt; combined-potentially-duplicated-columns (tc/head 5) (tc/drop-rows (fn [row] (every? identity (map (fn [col-name] (not (nil? (col-name row)))) )))) ;; tc/row-count )</p>
<p>that do not have any differences across the three datasets. This is going to be verbose to inline so we’ll write a small helper:</p>
<p>looking for rows where there <em>is</em> a missing value in the main dataset but there <em>is</em> a value for that column in another dataset</p>
<p>filter out rows where all three datasets agree</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb56"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> datasets-concur? </span>[row col]</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">println</span> <span class="st">"*******************"</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">println</span> (col row))</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">println</span> ((<span class="kw">-&gt;&gt;</span> col <span class="kw">name</span> (<span class="kw">str</span> <span class="st">"characteristic."</span>) <span class="kw">keyword</span>) row))</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">println</span> ((<span class="kw">-&gt;&gt;</span> col <span class="kw">name</span> (<span class="kw">str</span> <span class="st">"land-sizes."</span>) <span class="kw">keyword</span>) row))</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">println</span> <span class="st">"*******************"</span>)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">=</span> (col row)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>     ((<span class="kw">-&gt;&gt;</span> col <span class="kw">name</span> (<span class="kw">str</span> <span class="st">"characteristic."</span>) <span class="kw">keyword</span>) row)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>     ((<span class="kw">-&gt;&gt;</span> col <span class="kw">name</span> (<span class="kw">str</span> <span class="st">"land-sizes."</span>) <span class="kw">keyword</span>) row)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb57"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> datasets-same? </span>[row col]</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">let</span> [v1 (col row)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>        v2 ((<span class="kw">-&gt;&gt;</span> col <span class="kw">name</span> (<span class="kw">str</span> <span class="st">"characteristic."</span>) <span class="kw">keyword</span>) row)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>        v3 ((<span class="kw">-&gt;&gt;</span> col <span class="kw">name</span> (<span class="kw">str</span> <span class="st">"land-sizes."</span>) <span class="kw">keyword</span>) row)]</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">;; either all values are the same</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">;; (or</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">;;  (-&gt; [v1 v2 v3] set count (= 1)))</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">-&gt;&gt;</span> [v1 v2 v3] <span class="kw">set</span> (<span class="kw">remove</span> <span class="kw">nil?</span>) <span class="kw">count</span> (<span class="kw">=</span> <span class="dv">1</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb58"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> no-discrepancies </span>[row]</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">every?</span> <span class="kw">identity</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>          (<span class="kw">map</span> (<span class="kw">partial</span> datasets-concur? row)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>           [<span class="at">:municipal-unit</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">:civic-number</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">:civic-additional</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">:civic-direction</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">:civic-street-name</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">:civic-suffix</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">:civic-city-name</span>])))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb59"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> has-discrepancy? </span>[row col-name]</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">;; returns true if values differ and are not nil, otherwise false</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">let</span> [v1 (col-name row)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>        v2 ((<span class="kw">-&gt;&gt;</span> col-name <span class="kw">name</span> (<span class="kw">str</span> <span class="st">"characteristic."</span>) <span class="kw">keyword</span>) row)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>        v3 ((<span class="kw">-&gt;&gt;</span> col-name <span class="kw">name</span> (<span class="kw">str</span> <span class="st">"land-sizes."</span>) <span class="kw">keyword</span>) row)]</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">-&gt;&gt;</span> [v1 v2 v3] <span class="kw">set</span> (<span class="kw">remove</span> <span class="kw">nil?</span>) <span class="kw">count</span> (<span class="kw">&lt;=</span> <span class="dv">2</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb60"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> with-discrepancies </span>[row]</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">some</span> <span class="kw">identity</span> (<span class="kw">map</span> (<span class="kw">partial</span> has-discrepancy? row) common-columns))</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb61"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> combined-potentially-duplicated-columns</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">;; (tc/head 100)</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">;; (tc/drop-rows no-discrepancies)</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows with-discrepancies)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">;; (tc/select-rows #(not= (:municipal-unit %)</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">;;                        ((-&gt;&gt; :municipal-unit</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">;;                              name</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">;;                              (str "characteristic.")</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">;;                              keyword) %)</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">;;                        ((-&gt;&gt; :municipal-unit</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">;;                              name</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">;;                              (str "land-sizes.")</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">;;                              keyword) %)))</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">;; tc/row-count</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>inner-join [4 20]:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">:assessment-account-number</th>
<th>:municipal-unit</th>
<th style="text-align: right;">:civic-number</th>
<th>:civic-additional</th>
<th>:civic-direction</th>
<th>:civic-street-name</th>
<th>:civic-suffix</th>
<th>:civic-city-name</th>
<th>:characteristics.municipal-unit</th>
<th style="text-align: right;">:characteristics.civic-number</th>
<th>:characteristics.civic-additional</th>
<th>:characteristics.civic-direction</th>
<th>:characteristics.civic-street-name</th>
<th>:characteristics.civic-city-name</th>
<th>:land-sizes.municipal-unit</th>
<th style="text-align: right;">:land-sizes.civic-number</th>
<th>:land-sizes.civic-additional</th>
<th>:land-sizes.civic-direction</th>
<th>:land-sizes.civic-street-name</th>
<th>:land-sizes.civic-city-name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">10823821</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">257</td>
<td></td>
<td></td>
<td>MEEK ARM</td>
<td>TRAIL</td>
<td>EAST UNIACKE</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">0</td>
<td></td>
<td></td>
<td>MEEK ARM</td>
<td>EAST UNIACKE</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">0</td>
<td></td>
<td></td>
<td>MEEK ARM</td>
<td>EAST UNIACKE</td>
</tr>
<tr class="even">
<td style="text-align: right;">10823821</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">257</td>
<td></td>
<td></td>
<td>MEEK ARM</td>
<td>TRAIL</td>
<td>EAST UNIACKE</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">0</td>
<td></td>
<td></td>
<td>MEEK ARM</td>
<td>EAST UNIACKE</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">0</td>
<td></td>
<td></td>
<td>MEEK ARM</td>
<td>EAST UNIACKE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">733814</td>
<td>MUNICIPALITY OF THE COUNTY OF INVERNESS</td>
<td style="text-align: right;">15308</td>
<td></td>
<td></td>
<td>CABOT</td>
<td>TRAIL</td>
<td>CHETICAMP</td>
<td>MUNICIPALITY OF THE COUNTY OF INVERNESS</td>
<td style="text-align: right;">15308</td>
<td></td>
<td></td>
<td>CABOT</td>
<td>CH�TICAMP</td>
<td>MUNICIPALITY OF THE COUNTY OF INVERNESS</td>
<td style="text-align: right;">15308</td>
<td></td>
<td></td>
<td>CABOT</td>
<td>CH�TICAMP</td>
</tr>
<tr class="even">
<td style="text-align: right;">10823714</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">173</td>
<td></td>
<td></td>
<td>MEEK ARM</td>
<td>TRAIL</td>
<td>EAST UNIACKE</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">0</td>
<td></td>
<td></td>
<td>MEEK ARM</td>
<td>EAST UNIACKE</td>
<td>MUNI. OF THE DISTRICT OF EAST HANTS</td>
<td style="text-align: right;">0</td>
<td></td>
<td></td>
<td>MEEK ARM</td>
<td>EAST UNIACKE</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb62"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>combined-potentially-duplicated-columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>inner-join [363075 20]:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">:assessment-account-number</th>
<th>:municipal-unit</th>
<th style="text-align: right;">:civic-number</th>
<th>:civic-additional</th>
<th>:civic-direction</th>
<th>:civic-street-name</th>
<th>:civic-suffix</th>
<th>:civic-city-name</th>
<th>:characteristics.municipal-unit</th>
<th style="text-align: right;">:characteristics.civic-number</th>
<th>:characteristics.civic-additional</th>
<th>:characteristics.civic-direction</th>
<th>:characteristics.civic-street-name</th>
<th>:characteristics.civic-city-name</th>
<th>:land-sizes.municipal-unit</th>
<th style="text-align: right;">:land-sizes.civic-number</th>
<th>:land-sizes.civic-additional</th>
<th>:land-sizes.civic-direction</th>
<th>:land-sizes.civic-street-name</th>
<th>:land-sizes.civic-city-name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">911593</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">445</td>
<td></td>
<td></td>
<td>WEST PORTERS LAKE</td>
<td>RD</td>
<td>PORTERS LAKE</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">445</td>
<td></td>
<td></td>
<td>WEST PORTERS LAKE</td>
<td>PORTERS LAKE</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">445</td>
<td></td>
<td></td>
<td>WEST PORTERS LAKE</td>
<td>PORTERS LAKE</td>
</tr>
<tr class="even">
<td style="text-align: right;">911593</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">445</td>
<td></td>
<td></td>
<td>WEST PORTERS LAKE</td>
<td>RD</td>
<td>PORTERS LAKE</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">445</td>
<td></td>
<td></td>
<td>WEST PORTERS LAKE</td>
<td>PORTERS LAKE</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">445</td>
<td></td>
<td></td>
<td>WEST PORTERS LAKE</td>
<td>PORTERS LAKE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8502838</td>
<td>MUNICIPALITY OF THE DISTRICT OF ARGYLE</td>
<td style="text-align: right;">1125</td>
<td></td>
<td></td>
<td>DU TITTLE</td>
<td>CH</td>
<td>SURETTES ISLAND</td>
<td>MUNICIPALITY OF THE DISTRICT OF ARGYLE</td>
<td style="text-align: right;">1125</td>
<td></td>
<td></td>
<td>DU TITTLE</td>
<td>SURETTES ISLAND</td>
<td>MUNICIPALITY OF THE DISTRICT OF ARGYLE</td>
<td style="text-align: right;">1125</td>
<td></td>
<td></td>
<td>DU TITTLE</td>
<td>SURETTES ISLAND</td>
</tr>
<tr class="even">
<td style="text-align: right;">3698858</td>
<td>MUNICIPALITY OF THE COUNTY OF KINGS</td>
<td style="text-align: right;">9739</td>
<td></td>
<td></td>
<td>MAIN</td>
<td>ST</td>
<td>CANNING</td>
<td>MUNICIPALITY OF THE COUNTY OF KINGS</td>
<td style="text-align: right;">9739</td>
<td></td>
<td></td>
<td>MAIN</td>
<td>CANNING</td>
<td>MUNICIPALITY OF THE COUNTY OF KINGS</td>
<td style="text-align: right;">9739</td>
<td></td>
<td></td>
<td>MAIN</td>
<td>CANNING</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3698858</td>
<td>MUNICIPALITY OF THE COUNTY OF KINGS</td>
<td style="text-align: right;">9739</td>
<td></td>
<td></td>
<td>MAIN</td>
<td>ST</td>
<td>CANNING</td>
<td>MUNICIPALITY OF THE COUNTY OF KINGS</td>
<td style="text-align: right;">9739</td>
<td></td>
<td></td>
<td>MAIN</td>
<td>CANNING</td>
<td>MUNICIPALITY OF THE COUNTY OF KINGS</td>
<td style="text-align: right;">9739</td>
<td></td>
<td></td>
<td>MAIN</td>
<td>CANNING</td>
</tr>
<tr class="even">
<td style="text-align: right;">3944026</td>
<td>MUNI. OF THE DISTRICT OF GUYSBOROUGH</td>
<td style="text-align: right;">5231</td>
<td></td>
<td></td>
<td>HIGHWAY 316</td>
<td></td>
<td>CHARLOS COVE</td>
<td>MUNI. OF THE DISTRICT OF GUYSBOROUGH</td>
<td style="text-align: right;">5231</td>
<td></td>
<td></td>
<td>HIGHWAY 316</td>
<td>CHARLOS COVE</td>
<td>MUNI. OF THE DISTRICT OF GUYSBOROUGH</td>
<td style="text-align: right;">5231</td>
<td></td>
<td></td>
<td>HIGHWAY 316</td>
<td>CHARLOS COVE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3944026</td>
<td>MUNI. OF THE DISTRICT OF GUYSBOROUGH</td>
<td style="text-align: right;">5231</td>
<td></td>
<td></td>
<td>HIGHWAY 316</td>
<td></td>
<td>CHARLOS COVE</td>
<td>MUNI. OF THE DISTRICT OF GUYSBOROUGH</td>
<td style="text-align: right;">5231</td>
<td></td>
<td></td>
<td>HIGHWAY 316</td>
<td>CHARLOS COVE</td>
<td>MUNI. OF THE DISTRICT OF GUYSBOROUGH</td>
<td style="text-align: right;">5231</td>
<td></td>
<td></td>
<td>HIGHWAY 316</td>
<td>CHARLOS COVE</td>
</tr>
<tr class="even">
<td style="text-align: right;">3944026</td>
<td>MUNI. OF THE DISTRICT OF GUYSBOROUGH</td>
<td style="text-align: right;">5231</td>
<td></td>
<td></td>
<td>HIGHWAY 316</td>
<td></td>
<td>CHARLOS COVE</td>
<td>MUNI. OF THE DISTRICT OF GUYSBOROUGH</td>
<td style="text-align: right;">5231</td>
<td></td>
<td></td>
<td>HIGHWAY 316</td>
<td>CHARLOS COVE</td>
<td>MUNI. OF THE DISTRICT OF GUYSBOROUGH</td>
<td style="text-align: right;">5231</td>
<td></td>
<td></td>
<td>HIGHWAY 316</td>
<td>CHARLOS COVE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3885003</td>
<td>MUNICIPALITY OF THE COUNTY OF INVERNESS</td>
<td style="text-align: right;">1394</td>
<td></td>
<td></td>
<td>MABOU HARBOUR</td>
<td>RD</td>
<td>MABOU HARBOUR</td>
<td>MUNICIPALITY OF THE COUNTY OF INVERNESS</td>
<td style="text-align: right;">1394</td>
<td></td>
<td></td>
<td>MABOU HARBOUR</td>
<td>MABOU HARBOUR</td>
<td>MUNICIPALITY OF THE COUNTY OF INVERNESS</td>
<td style="text-align: right;">1394</td>
<td></td>
<td></td>
<td>MABOU HARBOUR</td>
<td>MABOU HARBOUR</td>
</tr>
<tr class="even">
<td style="text-align: right;">3885003</td>
<td>MUNICIPALITY OF THE COUNTY OF INVERNESS</td>
<td style="text-align: right;">1394</td>
<td></td>
<td></td>
<td>MABOU HARBOUR</td>
<td>RD</td>
<td>MABOU HARBOUR</td>
<td>MUNICIPALITY OF THE COUNTY OF INVERNESS</td>
<td style="text-align: right;">1394</td>
<td></td>
<td></td>
<td>MABOU HARBOUR</td>
<td>MABOU HARBOUR</td>
<td>MUNICIPALITY OF THE COUNTY OF INVERNESS</td>
<td style="text-align: right;">1394</td>
<td></td>
<td></td>
<td>MABOU HARBOUR</td>
<td>MABOU HARBOUR</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td style="text-align: right;">10863791</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td style="text-align: right;">320</td>
<td></td>
<td></td>
<td>EVELYN</td>
<td>DR</td>
<td>PARKDALE</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td style="text-align: right;">320</td>
<td></td>
<td></td>
<td>EVELYN</td>
<td>PARKDALE</td>
<td>MUNI. OF THE DISTRICT OF LUNENBURG</td>
<td style="text-align: right;">320</td>
<td></td>
<td></td>
<td>EVELYN</td>
<td>PARKDALE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2745755</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">1178</td>
<td></td>
<td></td>
<td>KETCH HARBOUR</td>
<td>RD</td>
<td>KETCH HARBOUR</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">1178</td>
<td></td>
<td></td>
<td>KETCH HARBOUR</td>
<td>KETCH HARBOUR</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">1178</td>
<td></td>
<td></td>
<td>KETCH HARBOUR</td>
<td>KETCH HARBOUR</td>
</tr>
<tr class="even">
<td style="text-align: right;">2745755</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">1178</td>
<td></td>
<td></td>
<td>KETCH HARBOUR</td>
<td>RD</td>
<td>KETCH HARBOUR</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">1178</td>
<td></td>
<td></td>
<td>KETCH HARBOUR</td>
<td>KETCH HARBOUR</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">1178</td>
<td></td>
<td></td>
<td>KETCH HARBOUR</td>
<td>KETCH HARBOUR</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2745755</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">1178</td>
<td></td>
<td></td>
<td>KETCH HARBOUR</td>
<td>RD</td>
<td>KETCH HARBOUR</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">1178</td>
<td></td>
<td></td>
<td>KETCH HARBOUR</td>
<td>KETCH HARBOUR</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">1178</td>
<td></td>
<td></td>
<td>KETCH HARBOUR</td>
<td>KETCH HARBOUR</td>
</tr>
<tr class="even">
<td style="text-align: right;">10751993</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>ARDOISE</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td>ARDOISE</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td>ARDOISE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10751993</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>ARDOISE</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td>ARDOISE</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td>ARDOISE</td>
</tr>
<tr class="even">
<td style="text-align: right;">10751993</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>ARDOISE</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td>ARDOISE</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td>ARDOISE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10751993</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td></td>
<td>ARDOISE</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td>ARDOISE</td>
<td>WEST HANTS REGIONAL MUNICIPALITY</td>
<td style="text-align: right;">7289</td>
<td></td>
<td></td>
<td>HIGHWAY 1</td>
<td>ARDOISE</td>
</tr>
<tr class="even">
<td style="text-align: right;">7667817</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">56</td>
<td></td>
<td></td>
<td>LAKE</td>
<td>RD</td>
<td>PLEASANT VALLEY</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">56</td>
<td></td>
<td></td>
<td>LAKE</td>
<td>PLEASANT VALLEY</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">56</td>
<td></td>
<td></td>
<td>LAKE</td>
<td>PLEASANT VALLEY</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10986400</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">538</td>
<td></td>
<td></td>
<td>MIDNIGHT</td>
<td>RUN</td>
<td>MIDDLE SACKVILLE</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">538</td>
<td></td>
<td></td>
<td>MIDNIGHT</td>
<td>MIDDLE SACKVILLE</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">538</td>
<td></td>
<td></td>
<td>MIDNIGHT</td>
<td>MIDDLE SACKVILLE</td>
</tr>
<tr class="even">
<td style="text-align: right;">10986400</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">538</td>
<td></td>
<td></td>
<td>MIDNIGHT</td>
<td>RUN</td>
<td>MIDDLE SACKVILLE</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">538</td>
<td></td>
<td></td>
<td>MIDNIGHT</td>
<td>MIDDLE SACKVILLE</td>
<td>HALIFAX REGIONAL MUNICIPALITY (HRM)</td>
<td style="text-align: right;">538</td>
<td></td>
<td></td>
<td>MIDNIGHT</td>
<td>MIDDLE SACKVILLE</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb63"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  (tc/info characteristics)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a> (tc/select-rows #(#{<span class="at">:municipal-unit</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">:civic-number</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">:civic-additional</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">:civic-direction</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">:civic-street-name</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">:civic-suffix</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">:civic-city-name</span>}</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>                    (<span class="at">:col-name</span> <span class="va">%</span>)))</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>(tc/select-columns [<span class="at">:col-name</span> <span class="at">:n-missing</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>characteristics: descriptive-stats [6 2]:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>:col-name</th>
<th style="text-align: right;">:n-missing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:municipal-unit</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td>:civic-number</td>
<td style="text-align: right;">4967</td>
</tr>
<tr class="odd">
<td>:civic-additional</td>
<td style="text-align: right;">377922</td>
</tr>
<tr class="even">
<td>:civic-direction</td>
<td style="text-align: right;">377760</td>
</tr>
<tr class="odd">
<td>:civic-street-name</td>
<td style="text-align: right;">550</td>
</tr>
<tr class="even">
<td>:civic-city-name</td>
<td style="text-align: right;">492</td>
</tr>
</tbody>
</table>
</div>
<p>(-&gt; housing-data (haclo/layer-point #:haclo{:x :square-foot-living-area :y :sale-price :xscale {:type “log”}}))</p>
<p>Contains information licensed under the Open Data &amp; Information Government Licence – PVSC &amp; Participating Municipalities</p>
<p>Now that our dataset is assembled and cleaned up, I’ll write it to a new file for easier access in the next steps.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb64"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>(tc/write-nippy! housing-data <span class="st">"data/end_to_end/housing-data.nippy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb65"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="va">nil</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div style="background-color:grey;height:2px;width:100%;"></div>
<div><pre><small><small>source: <a href="https://github.com/scicloj/clojure-data-cookbook/blob/main/src/book/part_0_end_to_end/1_data_import_and_cleanup_example.clj">src/book/part_0_end_to_end/1_data_import_and_cleanup_example.clj</a></small></small></pre></div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./src/book/part_0_end_to_end/0_intro.html" class="pagination-link" aria-label="End to End">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">End to End</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./book.part_0_end_to_end.2_data_preparation_example.html" class="pagination-link" aria-label="Data Transformation Example">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Transformation Example</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>